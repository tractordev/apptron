var wi=Object.create;var en=Object.defineProperty;var bi=Object.getOwnPropertyDescriptor;var gi=Object.getOwnPropertyNames;var mi=Object.getPrototypeOf,xi=Object.prototype.hasOwnProperty;var Ei=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var cs=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),tn=(r,e)=>{for(var t in e)en(r,t,{get:e[t],enumerable:!0})},Ri=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of gi(e))!xi.call(r,i)&&i!==t&&en(r,i,{get:()=>e[i],enumerable:!(n=bi(e,i))||n.enumerable});return r};var rn=(r,e,t)=>(t=r!=null?wi(mi(r)):{},Ri(e||!r||!r.__esModule?en(t,"default",{value:r,enumerable:!0}):t,r));var ns=cs((Pu,oi)=>{"use strict";oi.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var hi=cs((os,di)=>{(function(r,e){typeof define=="function"&&define.amd?define([],e):typeof os=="object"?di.exports=e():r.untar=e()})(os,function(){"use strict";function r(l){function d(O){for(var T=0,U=f.length;T<U;++T)f[T](O);m.push(O)}if(typeof Promise!="function")throw new Error("Promise implementation not available in this environment.");var f=[],m=[],b=new Promise(function(O,T){l(O,T,d)});b.progress=function(O){if(typeof O!="function")throw new Error("cb is not a function.");for(var T=0,U=m.length;T<U;++T)O(m[T]);return f.push(O),b};var A=b.then;return b.then=function(O,T,U){return A.call(b,O,T),U!==void 0&&b.progress(U),b},b}function e(l){if(!(l instanceof ArrayBuffer))throw new TypeError("arrayBuffer is not an instance of ArrayBuffer.");if(!i.Worker)throw new Error("Worker implementation is not available in this environment.");return new r(function(d,f,m){var b=new Worker(n),A=[];b.onerror=function(O){f(O)},b.onmessage=function(O){switch(O=O.data,O.type){case"log":console[O.data.level]("Worker: "+O.data.msg);break;case"extract":var T=t(O.data);A.push(T),m(T);break;case"complete":b.terminate(),d(A);break;case"error":b.terminate(),f(new Error(O.data.message));break;default:b.terminate(),f(new Error("Unknown message from worker: "+O.type))}},b.postMessage({type:"extract",buffer:l},[l])})}function t(l){return Object.defineProperties(l,a),l}var n,i=window||this,s=i.URL||i.webkitURL,a={blob:{get:function(){return this._blob||(this._blob=new Blob([this.buffer]))}},getBlobUrl:{value:function(){return this._blobUrl||(this._blobUrl=s.createObjectURL(this.blob))}},readAsString:{value:function(){for(var l=this.buffer,d=l.byteLength,f=1,m=new DataView(l),b=[],A=0;A<d;++A){var O=m.getUint8(A*f,!0);b.push(O)}return this._string=String.fromCharCode.apply(null,b)}},readAsJSON:{value:function(){return JSON.parse(this.readAsString())}}};return n=(window||this).URL.createObjectURL(new Blob(['"use strict";function UntarWorker(){}function decodeUTF8(e){for(var r="",t=0;t<e.length;){var a=e[t++];if(a>127){if(a>191&&a<224){if(t>=e.length)throw"UTF-8 decode: incomplete 2-byte sequence";a=(31&a)<<6|63&e[t]}else if(a>223&&a<240){if(t+1>=e.length)throw"UTF-8 decode: incomplete 3-byte sequence";a=(15&a)<<12|(63&e[t])<<6|63&e[++t]}else{if(!(a>239&&a<248))throw"UTF-8 decode: unknown multibyte start 0x"+a.toString(16)+" at index "+(t-1);if(t+2>=e.length)throw"UTF-8 decode: incomplete 4-byte sequence";a=(7&a)<<18|(63&e[t])<<12|(63&e[++t])<<6|63&e[++t]}++t}if(a<=65535)r+=String.fromCharCode(a);else{if(!(a<=1114111))throw"UTF-8 decode: code point 0x"+a.toString(16)+" exceeds UTF-16 reach";a-=65536,r+=String.fromCharCode(a>>10|55296),r+=String.fromCharCode(1023&a|56320)}}return r}function PaxHeader(e){this._fields=e}function TarFile(){}function UntarStream(e){this._bufferView=new DataView(e),this._position=0}function UntarFileStream(e){this._stream=new UntarStream(e),this._globalPaxHeader=null}if(UntarWorker.prototype={onmessage:function(e){try{if("extract"!==e.data.type)throw new Error("Unknown message type: "+e.data.type);this.untarBuffer(e.data.buffer)}catch(r){this.postError(r)}},postError:function(e){this.postMessage({type:"error",data:{message:e.message}})},postLog:function(e,r){this.postMessage({type:"log",data:{level:e,msg:r}})},untarBuffer:function(e){try{for(var r=new UntarFileStream(e);r.hasNext();){var t=r.next();this.postMessage({type:"extract",data:t},[t.buffer])}this.postMessage({type:"complete"})}catch(a){this.postError(a)}},postMessage:function(e,r){self.postMessage(e,r)}},"undefined"!=typeof self){var worker=new UntarWorker;self.onmessage=function(e){worker.onmessage(e)}}PaxHeader.parse=function(e){for(var r=new Uint8Array(e),t=[];r.length>0;){var a=parseInt(decodeUTF8(r.subarray(0,r.indexOf(32)))),n=decodeUTF8(r.subarray(0,a)),i=n.match(/^\\d+ ([^=]+)=(.*)\\n$/);if(null===i)throw new Error("Invalid PAX header data format.");var s=i[1],o=i[2];0===o.length?o=null:null!==o.match(/^\\d+$/)&&(o=parseInt(o));var f={name:s,value:o};t.push(f),r=r.subarray(a)}return new PaxHeader(t)},PaxHeader.prototype={applyHeader:function(e){this._fields.forEach(function(r){var t=r.name,a=r.value;"path"===t?(t="name",void 0!==e.prefix&&delete e.prefix):"linkpath"===t&&(t="linkname"),null===a?delete e[t]:e[t]=a})}},UntarStream.prototype={readString:function(e){for(var r=1,t=e*r,a=[],n=0;n<e;++n){var i=this._bufferView.getUint8(this.position()+n*r,!0);if(0===i)break;a.push(i)}return this.seek(t),String.fromCharCode.apply(null,a)},readBuffer:function(e){var r;if("function"==typeof ArrayBuffer.prototype.slice)r=this._bufferView.buffer.slice(this.position(),this.position()+e);else{r=new ArrayBuffer(e);var t=new Uint8Array(r),a=new Uint8Array(this._bufferView.buffer,this.position(),e);t.set(a)}return this.seek(e),r},seek:function(e){this._position+=e},peekUint32:function(){return this._bufferView.getUint32(this.position(),!0)},position:function(e){return void 0===e?this._position:void(this._position=e)},size:function(){return this._bufferView.byteLength}},UntarFileStream.prototype={hasNext:function(){return this._stream.position()+4<this._stream.size()&&0!==this._stream.peekUint32()},next:function(){return this._readNextFile()},_readNextFile:function(){var e=this._stream,r=new TarFile,t=!1,a=null,n=e.position(),i=n+512;switch(r.name=e.readString(100),r.mode=e.readString(8),r.uid=parseInt(e.readString(8)),r.gid=parseInt(e.readString(8)),r.size=parseInt(e.readString(12),8),r.mtime=parseInt(e.readString(12),8),r.checksum=parseInt(e.readString(8)),r.type=e.readString(1),r.linkname=e.readString(100),r.ustarFormat=e.readString(6),r.ustarFormat.indexOf("ustar")>-1&&(r.version=e.readString(2),r.uname=e.readString(32),r.gname=e.readString(32),r.devmajor=parseInt(e.readString(8)),r.devminor=parseInt(e.readString(8)),r.namePrefix=e.readString(155),r.namePrefix.length>0&&(r.name=r.namePrefix+"/"+r.name)),e.position(i),r.type){case"0":case"":r.buffer=e.readBuffer(r.size);break;case"1":break;case"2":break;case"3":break;case"4":break;case"5":break;case"6":break;case"7":break;case"g":t=!0,this._globalPaxHeader=PaxHeader.parse(e.readBuffer(r.size));break;case"x":t=!0,a=PaxHeader.parse(e.readBuffer(r.size))}void 0===r.buffer&&(r.buffer=new ArrayBuffer(0));var s=i+r.size;return r.size%512!==0&&(s+=512-r.size%512),e.position(s),t&&(r=this._readNextFile()),null!==this._globalPaxHeader&&this._globalPaxHeader.applyHeader(r),null!==a&&a.applyHeader(r),r}};'])),e})});var nn;try{nn=new TextDecoder}catch{}var k,je,E=0;var _s=[],Si=105,Oi=57342,Ii=57343,us=57337;var ds=6,nt={},St=11281e4,Ue=1681e4;var sn=_s,an=0,M={},H,tr,rr=0,It=0,J,we,$=[],on=[],ce,ae,Ot,hs={useRecords:!1,mapsAsObjects:!0},At=!1,ws=2;try{new Function("")}catch{ws=1/0}var Ge=class r{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[t,n]of Object.entries(e.keyMap))this.mapKey.set(n,t)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let t=new Map;for(let[n,i]of Object.entries(e))t.set(this._keyMap.hasOwnProperty(n)?this._keyMap[n]:n,i);return t}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[n,i]of Object.entries(this._keyMap))this._mapKey.set(i,n)}let t={};return e.forEach((n,i)=>t[be(this._mapKey.has(i)?this._mapKey.get(i):i)]=n),t}mapDecode(e,t){let n=this.decode(e);if(this._keyMap)switch(n.constructor.name){case"Array":return n.map(i=>this.decodeKeys(i))}return n}decode(e,t){if(k)return xs(()=>(nr(),this?this.decode(e,t):r.prototype.decode.call(hs,e,t)));je=t>-1?t:e.length,E=0,an=0,It=0,tr=null,sn=_s,J=null,k=e;try{ae=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(n){throw k=null,e instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof r){if(M=this,ce=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return H=this.structures,Qt();(!H||H.length>0)&&(H=[])}else M=hs,(!H||H.length>0)&&(H=[]),ce=null;return Qt()}decodeMultiple(e,t){let n,i=0;try{let s=e.length;At=!0;let a=this?this.decode(e,s):dn.decode(e,s);if(t){if(t(a)===!1)return;for(;E<s;)if(i=E,t(Qt())===!1)return}else{for(n=[a];E<s;)i=E,n.push(Qt());return n}}catch(s){throw s.lastPosition=i,s.values=n,s}finally{At=!1,nr()}}};function Qt(){try{let r=V();if(J){if(E>=J.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}E=J.postBundlePosition,J=null}if(E==je)H=null,k=null,we&&(we=null);else if(E>je){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!At)throw new Error("Data read, but end of buffer not reached");return r}catch(r){throw nr(),(r instanceof RangeError||r.message.startsWith("Unexpected end of buffer"))&&(r.incomplete=!0),r}}function V(){let r=k[E++],e=r>>5;if(r=r&31,r>23)switch(r){case 24:r=k[E++];break;case 25:if(e==7)return Di();r=ae.getUint16(E),E+=2;break;case 26:if(e==7){let t=ae.getFloat32(E);if(M.useFloat32>2){let n=sr[(k[E]&127)<<1|k[E+1]>>7];return E+=4,(n*t+(t>0?.5:-.5)>>0)/n}return E+=4,t}r=ae.getUint32(E),E+=4;break;case 27:if(e==7){let t=ae.getFloat64(E);return E+=8,t}if(e>1){if(ae.getUint32(E)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");r=ae.getUint32(E+4)}else M.int64AsNumber?(r=ae.getUint32(E)*4294967296,r+=ae.getUint32(E+4)):r=ae.getBigUint64(E);E+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let t=[],n,i=0;for(;(n=V())!=nt;){if(i>=St)throw new Error(`Array length exceeds ${St}`);t[i++]=n}return e==4?t:e==3?t.join(""):Buffer.concat(t);case 5:let s;if(M.mapsAsObjects){let a={},l=0;if(M.keyMap)for(;(s=V())!=nt;){if(l++>=Ue)throw new Error(`Property count exceeds ${Ue}`);a[be(M.decodeKey(s))]=V()}else for(;(s=V())!=nt;){if(l++>=Ue)throw new Error(`Property count exceeds ${Ue}`);a[be(s)]=V()}return a}else{Ot&&(M.mapsAsObjects=!0,Ot=!1);let a=new Map;if(M.keyMap){let l=0;for(;(s=V())!=nt;){if(l++>=Ue)throw new Error(`Map size exceeds ${Ue}`);a.set(M.decodeKey(s),V())}}else{let l=0;for(;(s=V())!=nt;){if(l++>=Ue)throw new Error(`Map size exceeds ${Ue}`);a.set(s,V())}}return a}case 7:return nt;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+r)}switch(e){case 0:return r;case 1:return~r;case 2:return Ti(r);case 3:if(It>=E)return tr.slice(E-rr,(E+=r)-rr);if(It==0&&je<140&&r<32){let i=r<16?bs(r):Ni(r);if(i!=null)return i}return Ai(r);case 4:if(r>=St)throw new Error(`Array length exceeds ${St}`);let t=new Array(r);for(let i=0;i<r;i++)t[i]=V();return t;case 5:if(r>=Ue)throw new Error(`Map size exceeds ${St}`);if(M.mapsAsObjects){let i={};if(M.keyMap)for(let s=0;s<r;s++)i[be(M.decodeKey(V()))]=V();else for(let s=0;s<r;s++)i[be(V())]=V();return i}else{Ot&&(M.mapsAsObjects=!0,Ot=!1);let i=new Map;if(M.keyMap)for(let s=0;s<r;s++)i.set(M.decodeKey(V()),V());else for(let s=0;s<r;s++)i.set(V(),V());return i}case 6:if(r>=us){let i=H[r&8191];if(i)return i.read||(i.read=ln(i)),i.read();if(r<65536){if(r==Ii){let s=it(),a=V(),l=V();cn(a,l);let d={};if(M.keyMap)for(let f=2;f<s;f++){let m=M.decodeKey(l[f-2]);d[be(m)]=V()}else for(let f=2;f<s;f++){let m=l[f-2];d[be(m)]=V()}return d}else if(r==Oi){let s=it(),a=V();for(let l=2;l<s;l++)cn(a++,V());return V()}else if(r==us)return Fi();if(M.getShared&&(un(),i=H[r&8191],i))return i.read||(i.read=ln(i)),i.read()}}let n=$[r];if(n)return n.handlesRead?n(V):n(V());{let i=V();for(let s=0;s<on.length;s++){let a=on[s](r,i);if(a!==void 0)return a}return new xe(i,r)}case 7:switch(r){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let i=(ce||Ve())[r];if(i!==void 0)return i;throw new Error("Unknown token "+r)}default:if(isNaN(r)){let i=new Error("Unexpected end of CBOR data");throw i.incomplete=!0,i}throw new Error("Unknown CBOR token "+r)}}var ps=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function ln(r){if(!r)throw new Error("Structure is required in record definition");function e(){let t=k[E++];if(t=t&31,t>23)switch(t){case 24:t=k[E++];break;case 25:t=ae.getUint16(E),E+=2;break;case 26:t=ae.getUint32(E),E+=4;break;default:throw new Error("Expected array header, but got "+k[E-1])}let n=this.compiledReader;for(;n;){if(n.propertyCount===t)return n(V);n=n.next}if(this.slowReads++>=ws){let s=this.length==t?this:this.slice(0,t);return n=M.keyMap?new Function("r","return {"+s.map(a=>M.decodeKey(a)).map(a=>ps.test(a)?be(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"):new Function("r","return {"+s.map(a=>ps.test(a)?be(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"),this.compiledReader&&(n.next=this.compiledReader),n.propertyCount=t,this.compiledReader=n,n(V)}let i={};if(M.keyMap)for(let s=0;s<t;s++)i[be(M.decodeKey(this[s]))]=V();else for(let s=0;s<t;s++)i[be(this[s])]=V();return i}return r.slowReads=0,e}function be(r){if(typeof r=="string")return r==="__proto__"?"__proto_":r;if(typeof r=="number"||typeof r=="boolean"||typeof r=="bigint")return r.toString();if(r==null)return r+"";throw new Error("Invalid property name type "+typeof r)}var Ai=fn;function fn(r){let e;if(r<16&&(e=bs(r)))return e;if(r>64&&nn)return nn.decode(k.subarray(E,E+=r));let t=E+r,n=[];for(e="";E<t;){let i=k[E++];if((i&128)===0)n.push(i);else if((i&224)===192){let s=k[E++]&63;n.push((i&31)<<6|s)}else if((i&240)===224){let s=k[E++]&63,a=k[E++]&63;n.push((i&31)<<12|s<<6|a)}else if((i&248)===240){let s=k[E++]&63,a=k[E++]&63,l=k[E++]&63,d=(i&7)<<18|s<<12|a<<6|l;d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|d&1023),n.push(d)}else n.push(i);n.length>=4096&&(e+=re.apply(String,n),n.length=0)}return n.length>0&&(e+=re.apply(String,n)),e}var re=String.fromCharCode;function Ni(r){let e=E,t=new Array(r);for(let n=0;n<r;n++){let i=k[E++];if((i&128)>0){E=e;return}t[n]=i}return re.apply(String,t)}function bs(r){if(r<4)if(r<2){if(r===0)return"";{let e=k[E++];if((e&128)>1){E-=1;return}return re(e)}}else{let e=k[E++],t=k[E++];if((e&128)>0||(t&128)>0){E-=2;return}if(r<3)return re(e,t);let n=k[E++];if((n&128)>0){E-=3;return}return re(e,t,n)}else{let e=k[E++],t=k[E++],n=k[E++],i=k[E++];if((e&128)>0||(t&128)>0||(n&128)>0||(i&128)>0){E-=4;return}if(r<6){if(r===4)return re(e,t,n,i);{let s=k[E++];if((s&128)>0){E-=5;return}return re(e,t,n,i,s)}}else if(r<8){let s=k[E++],a=k[E++];if((s&128)>0||(a&128)>0){E-=6;return}if(r<7)return re(e,t,n,i,s,a);let l=k[E++];if((l&128)>0){E-=7;return}return re(e,t,n,i,s,a,l)}else{let s=k[E++],a=k[E++],l=k[E++],d=k[E++];if((s&128)>0||(a&128)>0||(l&128)>0||(d&128)>0){E-=8;return}if(r<10){if(r===8)return re(e,t,n,i,s,a,l,d);{let f=k[E++];if((f&128)>0){E-=9;return}return re(e,t,n,i,s,a,l,d,f)}}else if(r<12){let f=k[E++],m=k[E++];if((f&128)>0||(m&128)>0){E-=10;return}if(r<11)return re(e,t,n,i,s,a,l,d,f,m);let b=k[E++];if((b&128)>0){E-=11;return}return re(e,t,n,i,s,a,l,d,f,m,b)}else{let f=k[E++],m=k[E++],b=k[E++],A=k[E++];if((f&128)>0||(m&128)>0||(b&128)>0||(A&128)>0){E-=12;return}if(r<14){if(r===12)return re(e,t,n,i,s,a,l,d,f,m,b,A);{let O=k[E++];if((O&128)>0){E-=13;return}return re(e,t,n,i,s,a,l,d,f,m,b,A,O)}}else{let O=k[E++],T=k[E++];if((O&128)>0||(T&128)>0){E-=14;return}if(r<15)return re(e,t,n,i,s,a,l,d,f,m,b,A,O,T);let U=k[E++];if((U&128)>0){E-=15;return}return re(e,t,n,i,s,a,l,d,f,m,b,A,O,T,U)}}}}}function Ti(r){return M.copyBuffers?Uint8Array.prototype.slice.call(k,E,E+=r):k.subarray(E,E+=r)}var gs=new Float32Array(1),er=new Uint8Array(gs.buffer,0,4);function Di(){let r=k[E++],e=k[E++],t=(r&127)>>2;if(t===31)return e||r&3?NaN:r&128?-1/0:1/0;if(t===0){let n=((r&3)<<8|e)/16777216;return r&128?-n:n}return er[3]=r&128|(t>>1)+56,er[2]=(r&7)<<5|e>>3,er[1]=e<<5,er[0]=0,gs[0]}var Bf=new Array(4096);var xe=class{constructor(e,t){this.value=e,this.tag=t}};$[0]=r=>new Date(r);$[1]=r=>new Date(Math.round(r*1e3));$[2]=r=>{let e=BigInt(0);for(let t=0,n=r.byteLength;t<n;t++)e=BigInt(r[t])+(e<<BigInt(8));return e};$[3]=r=>BigInt(-1)-$[2](r);$[4]=r=>+(r[1]+"e"+r[0]);$[5]=r=>r[1]*Math.exp(r[0]*Math.log(2));var cn=(r,e)=>{r=r-57344;let t=H[r];t&&t.isShared&&((H.restoreStructures||(H.restoreStructures=[]))[r]=t),H[r]=e,e.read=ln(e)};$[Si]=r=>{let e=r.length,t=r[1];cn(r[0],t);let n={};for(let i=2;i<e;i++){let s=t[i-2];n[be(s)]=r[i]}return n};$[14]=r=>J?J[0].slice(J.position0,J.position0+=r):new xe(r,14);$[15]=r=>J?J[1].slice(J.position1,J.position1+=r):new xe(r,15);var Ui={Error,RegExp};$[27]=r=>(Ui[r[0]]||Error)(r[1],r[2]);var ms=r=>{if(k[E++]!=132){let t=new Error("Packed values structure must be followed by a 4 element array");throw k.length<E&&(t.incomplete=!0),t}let e=r();if(!e||!e.length){let t=new Error("Packed values structure must be followed by a 4 element array");throw t.incomplete=!0,t}return ce=ce?e.concat(ce.slice(e.length)):e,ce.prefixes=r(),ce.suffixes=r(),r()};ms.handlesRead=!0;$[51]=ms;$[ds]=r=>{if(!ce)if(M.getShared)un();else return new xe(r,ds);if(typeof r=="number")return ce[16+(r>=0?2*r:-2*r-1)];let e=new Error("No support for non-integer packed references yet");throw r===void 0&&(e.incomplete=!0),e};$[28]=r=>{we||(we=new Map,we.id=0);let e=we.id++,t=E,n=k[E],i;n>>5==4?i=[]:i={};let s={target:i};we.set(e,s);let a=r();return s.used?(Object.getPrototypeOf(i)!==Object.getPrototypeOf(a)&&(E=t,i=a,we.set(e,{target:i}),a=r()),Object.assign(i,a)):(s.target=a,a)};$[28].handlesRead=!0;$[29]=r=>{let e=we.get(r);return e.used=!0,e.target};$[258]=r=>new Set(r);($[259]=r=>(M.mapsAsObjects&&(M.mapsAsObjects=!1,Ot=!0),r())).handlesRead=!0;function st(r,e){return typeof r=="string"?r+e:r instanceof Array?r.concat(e):Object.assign({},r,e)}function Ve(){if(!ce)if(M.getShared)un();else throw new Error("No packed values available");return ce}var vi=1399353956;on.push((r,e)=>{if(r>=225&&r<=255)return st(Ve().prefixes[r-224],e);if(r>=28704&&r<=32767)return st(Ve().prefixes[r-28672],e);if(r>=1879052288&&r<=2147483647)return st(Ve().prefixes[r-1879048192],e);if(r>=216&&r<=223)return st(e,Ve().suffixes[r-216]);if(r>=27647&&r<=28671)return st(e,Ve().suffixes[r-27639]);if(r>=1811940352&&r<=1879048191)return st(e,Ve().suffixes[r-1811939328]);if(r==vi)return{packedValues:ce,structures:H.slice(0),version:e};if(r==55799)return e});var Ci=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,ys=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],ki=[64,68,69,70,71,72,77,78,79,85,86];for(let r=0;r<ys.length;r++)Pi(ys[r],ki[r]);function Pi(r,e){let t="get"+r.name.slice(0,-5),n;typeof r=="function"?n=r.BYTES_PER_ELEMENT:r=null;for(let i=0;i<2;i++){if(!i&&n==1)continue;let s=n==2?1:n==4?2:n==8?3:0;$[i?e:e-4]=n==1||i==Ci?a=>{if(!r)throw new Error("Could not find typed array for code "+e);return!M.copyBuffers&&(n===1||n===2&&!(a.byteOffset&1)||n===4&&!(a.byteOffset&3)||n===8&&!(a.byteOffset&7))?new r(a.buffer,a.byteOffset,a.byteLength>>s):new r(Uint8Array.prototype.slice.call(a,0).buffer)}:a=>{if(!r)throw new Error("Could not find typed array for code "+e);let l=new DataView(a.buffer,a.byteOffset,a.byteLength),d=a.length>>s,f=new r(d),m=l[t];for(let b=0;b<d;b++)f[b]=m.call(l,b<<s,i);return f}}}function Fi(){let r=it(),e=E+V();for(let n=2;n<r;n++){let i=it();E+=i}let t=E;return E=e,J=[fn(it()),fn(it())],J.position0=0,J.position1=0,J.postBundlePosition=E,E=t,V()}function it(){let r=k[E++]&31;if(r>23)switch(r){case 24:r=k[E++];break;case 25:r=ae.getUint16(E),E+=2;break;case 26:r=ae.getUint32(E),E+=4;break}return r}function un(){if(M.getShared){let r=xs(()=>(k=null,M.getShared()))||{},e=r.structures||[];M.sharedVersion=r.version,ce=M.sharedValues=r.packedValues,H===!0?M.structures=H=e:H.splice.apply(H,[0,e.length].concat(e))}}function xs(r){let e=je,t=E,n=an,i=rr,s=It,a=tr,l=sn,d=we,f=J,m=new Uint8Array(k.slice(0,je)),b=H,A=M,O=At,T=r();return je=e,E=t,an=n,rr=i,It=s,tr=a,sn=l,we=d,J=f,k=m,At=O,H=b,M=A,ae=new DataView(k.buffer,k.byteOffset,k.byteLength),T}function nr(){k=null,we=null,H=null}var sr=new Array(147);for(let r=0;r<256;r++)sr[r]=+("1e"+Math.floor(45.15-r*.30103));var dn=new Ge({useRecords:!1}),hn=dn.decode,Li=dn.decodeMultiple,ir={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};var ar;try{ar=new TextEncoder}catch{}var bn,As,fr=typeof globalThis=="object"&&globalThis.Buffer,Tt=typeof fr<"u",pn=Tt?fr.allocUnsafeSlow:Uint8Array,Es=Tt?fr:Uint8Array,Rs=256,Ss=Tt?4294967296:2144337920;var yn,_,z,c=0,Ce,Z=null,Bi=61440,Mi=/[\u0080-\uFFFF]/,de=Symbol("record-id"),Nt=class extends Ge{constructor(e){super(e),this.offset=0;let t,n,i,s,a,l;e=e||{};let d=Es.prototype.utf8Write?function(o,g,h){return _.utf8Write(o,g,h)}:ar&&ar.encodeInto?function(o,g){return ar.encodeInto(o,_.subarray(g)).written}:!1,f=this,m=e.structures||e.saveStructures,b=e.maxSharedStructures;if(b==null&&(b=m?128:0),b>8190)throw new Error("Maximum maxSharedStructure is 8190");let A=e.sequential;A&&(b=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let O,T,U=e.sharedValues,F;if(U){F=Object.create(null);for(let o=0,g=U.length;o<g;o++)F[U[o]]=o}let L=[],se=0,le=0;this.mapEncode=function(o,g){if(this._keyMap&&!this._mapped)switch(o.constructor.name){case"Array":o=o.map(h=>this.encodeKeys(h));break}return this.encode(o,g)},this.encode=function(o,g){if(_||(_=new pn(8192),z=new DataView(_.buffer,0,8192),c=0),Ce=_.length-10,Ce-c<2048?(_=new pn(_.length),z=new DataView(_.buffer,0,_.length),Ce=_.length-10,c=0):g===mn&&(c=c+7&2147483640),n=c,f.useSelfDescribedHeader&&(z.setUint32(c,3654940416),c+=3),l=f.structuredClone?new Map:null,f.bundleStrings&&typeof o!="string"?(Z=[],Z.size=1/0):Z=null,i=f.structures,i){if(i.uninitialized){let y=f.getShared()||{};f.structures=i=y.structures||[],f.sharedVersion=y.version;let p=f.sharedValues=y.packedValues;if(p){F={};for(let S=0,I=p.length;S<I;S++)F[p[S]]=S}}let h=i.length;if(h>b&&!A&&(h=b),!i.transitions){i.transitions=Object.create(null);for(let y=0;y<h;y++){let p=i[y];if(!p)continue;let S,I=i.transitions;for(let N=0,D=p.length;N<D;N++){I[de]===void 0&&(I[de]=y);let C=p[N];S=I[C],S||(S=I[C]=Object.create(null)),I=S}I[de]=y|1048576}}A||(i.nextId=h)}if(s&&(s=!1),a=i||[],T=F,e.pack){let h=new Map;if(h.values=[],h.encoder=f,h.maxValues=e.maxPrivatePackedValues||(F?16:1/0),h.objectMap=F||!1,h.samplingPackedValues=O,or(o,h),h.values.length>0){_[c++]=216,_[c++]=51,Oe(4);let y=h.values;v(y),Oe(0),Oe(0),T=Object.create(F||null);for(let p=0,S=y.length;p<S;p++)T[y[p]]=p}}yn=g&wn;try{if(yn)return;if(v(o),Z&&Is(n,v),f.offset=c,l&&l.idsToInsert){c+=l.idsToInsert.length*2,c>Ce&&fe(c),f.offset=c;let h=Gi(_.subarray(n,c),l.idsToInsert);return l=null,h}return g&mn?(_.start=n,_.end=c,_):_.subarray(n,c)}finally{if(i){if(le<10&&le++,i.length>b&&(i.length=b),se>1e4)i.transitions=null,le=0,se=0,L.length>0&&(L=[]);else if(L.length>0&&!A){for(let h=0,y=L.length;h<y;h++)L[h][de]=void 0;L=[]}}if(s&&f.saveShared){f.structures.length>b&&(f.structures=f.structures.slice(0,b));let h=_.subarray(n,c);return f.updateSharedData()===!1?f.encode(o):h}g&Xi&&(c=n)}},this.findCommonStringsToPack=()=>(O=new Map,F||(F=Object.create(null)),o=>{let g=o&&o.threshold||4,h=this.pack?o.maxPrivatePackedValues||16:0;U||(U=this.sharedValues=[]);for(let[y,p]of O)p.count>g&&(F[y]=h++,U.push(y),s=!0);for(;this.saveShared&&this.updateSharedData()===!1;);O=null});let v=o=>{c>Ce&&(_=fe(c));var g=typeof o,h;if(g==="string"){if(T){let I=T[o];if(I>=0){I<16?_[c++]=I+224:(_[c++]=198,I&1?v(15-I>>1):v(I-16>>1));return}else if(O&&!e.pack){let N=O.get(o);N?N.count++:O.set(o,{count:1})}}let y=o.length;if(Z&&y>=4&&y<1024){if((Z.size+=y)>Bi){let N,D=(Z[0]?Z[0].length*3+Z[1].length:0)+10;c+D>Ce&&(_=fe(c+D)),_[c++]=217,_[c++]=223,_[c++]=249,_[c++]=Z.position?132:130,_[c++]=26,N=c-n,c+=4,Z.position&&Is(n,v),Z=["",""],Z.size=0,Z.position=N}let I=Mi.test(o);Z[I?0:1]+=o,_[c++]=I?206:207,v(y);return}let p;y<32?p=1:y<256?p=2:y<65536?p=3:p=5;let S=y*3;if(c+S>Ce&&(_=fe(c+S)),y<64||!d){let I,N,D,C=c+p;for(I=0;I<y;I++)N=o.charCodeAt(I),N<128?_[C++]=N:N<2048?(_[C++]=N>>6|192,_[C++]=N&63|128):(N&64512)===55296&&((D=o.charCodeAt(I+1))&64512)===56320?(N=65536+((N&1023)<<10)+(D&1023),I++,_[C++]=N>>18|240,_[C++]=N>>12&63|128,_[C++]=N>>6&63|128,_[C++]=N&63|128):(_[C++]=N>>12|224,_[C++]=N>>6&63|128,_[C++]=N&63|128);h=C-c-p}else h=d(o,c+p,S);h<24?_[c++]=96|h:h<256?(p<2&&_.copyWithin(c+2,c+1,c+1+h),_[c++]=120,_[c++]=h):h<65536?(p<3&&_.copyWithin(c+3,c+2,c+2+h),_[c++]=121,_[c++]=h>>8,_[c++]=h&255):(p<5&&_.copyWithin(c+5,c+3,c+3+h),_[c++]=122,z.setUint32(c,h),c+=4),c+=h}else if(g==="number")if(!this.alwaysUseFloat&&o>>>0===o)o<24?_[c++]=o:o<256?(_[c++]=24,_[c++]=o):o<65536?(_[c++]=25,_[c++]=o>>8,_[c++]=o&255):(_[c++]=26,z.setUint32(c,o),c+=4);else if(!this.alwaysUseFloat&&o>>0===o)o>=-24?_[c++]=31-o:o>=-256?(_[c++]=56,_[c++]=~o):o>=-65536?(_[c++]=57,z.setUint16(c,~o),c+=2):(_[c++]=58,z.setUint32(c,~o),c+=4);else{let y;if((y=this.useFloat32)>0&&o<4294967296&&o>=-2147483648){_[c++]=250,z.setFloat32(c,o);let p;if(y<4||(p=o*sr[(_[c]&127)<<1|_[c+1]>>7])>>0===p){c+=4;return}else c--}_[c++]=251,z.setFloat64(c,o),c+=8}else if(g==="object")if(!o)_[c++]=246;else{if(l){let p=l.get(o);if(p){if(_[c++]=216,_[c++]=29,_[c++]=25,!p.references){let S=l.idsToInsert||(l.idsToInsert=[]);p.references=[],S.push(p)}p.references.push(c-n),c+=2;return}else l.set(o,{offset:c-n})}let y=o.constructor;if(y===Object)De(o);else if(y===Array){h=o.length,h<24?_[c++]=128|h:Oe(h);for(let p=0;p<h;p++)v(o[p])}else if(y===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(_[c++]=217,_[c++]=1,_[c++]=3),h=o.size,h<24?_[c++]=160|h:h<256?(_[c++]=184,_[c++]=h):h<65536?(_[c++]=185,_[c++]=h>>8,_[c++]=h&255):(_[c++]=186,z.setUint32(c,h),c+=4),f.keyMap)for(let[p,S]of o)v(f.encodeKey(p)),v(S);else for(let[p,S]of o)v(p),v(S);else{for(let p=0,S=bn.length;p<S;p++){let I=As[p];if(o instanceof I){let N=bn[p],D=N.tag;D==null&&(D=N.getTag&&N.getTag.call(this,o)),D<24?_[c++]=192|D:D<256?(_[c++]=216,_[c++]=D):D<65536?(_[c++]=217,_[c++]=D>>8,_[c++]=D&255):D>-1&&(_[c++]=218,z.setUint32(c,D),c+=4),N.encode.call(this,o,v,fe);return}}if(o[Symbol.iterator]){if(yn){let p=new Error("Iterable should be serialized as iterator");throw p.iteratorNotHandled=!0,p}_[c++]=159;for(let p of o)v(p);_[c++]=255;return}if(o[Symbol.asyncIterator]||_n(o)){let p=new Error("Iterable/blob should be serialized as iterator");throw p.iteratorNotHandled=!0,p}if(this.useToJSON&&o.toJSON){let p=o.toJSON();if(p!==o)return v(p)}De(o)}}else if(g==="boolean")_[c++]=o?245:244;else if(g==="bigint"){if(o<BigInt(1)<<BigInt(64)&&o>=0)_[c++]=27,z.setBigUint64(c,o);else if(o>-(BigInt(1)<<BigInt(64))&&o<0)_[c++]=59,z.setBigUint64(c,-o-BigInt(1));else if(this.largeBigIntToFloat)_[c++]=251,z.setFloat64(c,Number(o));else{o>=BigInt(0)?_[c++]=194:(_[c++]=195,o=BigInt(-1)-o);let y=[];for(;o;)y.push(Number(o&BigInt(255))),o>>=BigInt(8);gn(new Uint8Array(y.reverse()),fe);return}c+=8}else if(g==="undefined")_[c++]=247;else throw new Error("Unknown type: "+g)},De=this.useRecords===!1?this.variableMapSize?o=>{let g=Object.keys(o),h=Object.values(o),y=g.length;y<24?_[c++]=160|y:y<256?(_[c++]=184,_[c++]=y):y<65536?(_[c++]=185,_[c++]=y>>8,_[c++]=y&255):(_[c++]=186,z.setUint32(c,y),c+=4);let p;if(f.keyMap)for(let S=0;S<y;S++)v(f.encodeKey(g[S])),v(h[S]);else for(let S=0;S<y;S++)v(g[S]),v(h[S])}:o=>{_[c++]=185;let g=c-n;c+=2;let h=0;if(f.keyMap)for(let y in o)(typeof o.hasOwnProperty!="function"||o.hasOwnProperty(y))&&(v(f.encodeKey(y)),v(o[y]),h++);else for(let y in o)(typeof o.hasOwnProperty!="function"||o.hasOwnProperty(y))&&(v(y),v(o[y]),h++);_[g+++n]=h>>8,_[g+n]=h&255}:(o,g)=>{let h,y=a.transitions||(a.transitions=Object.create(null)),p=0,S=0,I,N;if(this.keyMap){N=Object.keys(o).map(C=>this.encodeKey(C)),S=N.length;for(let C=0;C<S;C++){let Rt=N[C];h=y[Rt],h||(h=y[Rt]=Object.create(null),p++),y=h}}else for(let C in o)(typeof o.hasOwnProperty!="function"||o.hasOwnProperty(C))&&(h=y[C],h||(y[de]&1048576&&(I=y[de]&65535),h=y[C]=Object.create(null),p++),y=h,S++);let D=y[de];if(D!==void 0)D&=65535,_[c++]=217,_[c++]=D>>8|224,_[c++]=D&255;else if(N||(N=y.__keys__||(y.__keys__=Object.keys(o))),I===void 0?(D=a.nextId++,D||(D=0,a.nextId=1),D>=Rs&&(a.nextId=(D=b)+1)):D=I,a[D]=N,D<b){_[c++]=217,_[c++]=D>>8|224,_[c++]=D&255,y=a.transitions;for(let C=0;C<S;C++)(y[de]===void 0||y[de]&1048576)&&(y[de]=D),y=y[N[C]];y[de]=D|1048576,s=!0}else{if(y[de]=D,z.setUint32(c,3655335680),c+=3,p&&(se+=le*p),L.length>=Rs-b&&(L.shift()[de]=void 0),L.push(y),Oe(S+2),v(57344+D),v(N),g)return;for(let C in o)(typeof o.hasOwnProperty!="function"||o.hasOwnProperty(C))&&v(o[C]);return}if(S<24?_[c++]=128|S:Oe(S),!g)for(let C in o)(typeof o.hasOwnProperty!="function"||o.hasOwnProperty(C))&&v(o[C])},fe=o=>{let g;if(o>16777216){if(o-n>Ss)throw new Error("Encoded buffer would be larger than maximum buffer size");g=Math.min(Ss,Math.round(Math.max((o-n)*(o>67108864?1.25:2),4194304)/4096)*4096)}else g=(Math.max(o-n<<2,_.length-1)>>12)+1<<12;let h=new pn(g);return z=new DataView(h.buffer,0,g),_.copy?_.copy(h,0,n,o):h.set(_.slice(n,o)),c-=n,n=0,Ce=h.length-10,_=h},te=100,_e=1e3;this.encodeAsIterable=function(o,g){return xt(o,g,ie)},this.encodeAsAsyncIterable=function(o,g){return xt(o,g,Et)};function*ie(o,g,h){let y=o.constructor;if(y===Object){let p=f.useRecords!==!1;p?De(o,!0):Os(Object.keys(o).length,160);for(let S in o){let I=o[S];p||v(S),I&&typeof I=="object"?g[S]?yield*ie(I,g[S]):yield*Me(I,g,S):v(I)}}else if(y===Array){let p=o.length;Oe(p);for(let S=0;S<p;S++){let I=o[S];I&&(typeof I=="object"||c-n>te)?g.element?yield*ie(I,g.element):yield*Me(I,g,"element"):v(I)}}else if(o[Symbol.iterator]&&!o.buffer){_[c++]=159;for(let p of o)p&&(typeof p=="object"||c-n>te)?g.element?yield*ie(p,g.element):yield*Me(p,g,"element"):v(p);_[c++]=255}else _n(o)?(Os(o.size,64),yield _.subarray(n,c),yield o,me()):o[Symbol.asyncIterator]?(_[c++]=159,yield _.subarray(n,c),yield o,me(),_[c++]=255):v(o);h&&c>n?yield _.subarray(n,c):c-n>te&&(yield _.subarray(n,c),me())}function*Me(o,g,h){let y=c-n;try{v(o),c-n>te&&(yield _.subarray(n,c),me())}catch(p){if(p.iteratorNotHandled)g[h]={},c=n+y,yield*ie.call(this,o,g[h]);else throw p}}function me(){te=_e,f.encode(null,wn)}function xt(o,g,h){return g&&g.chunkThreshold?te=_e=g.chunkThreshold:te=100,o&&typeof o=="object"?(f.encode(null,wn),h(o,f.iterateProperties||(f.iterateProperties={}),!0)):[f.encode(o)]}async function*Et(o,g){for(let h of ie(o,g,!0)){let y=h.constructor;if(y===Es||y===Uint8Array)yield h;else if(_n(h)){let p=h.stream().getReader(),S;for(;!(S=await p.read()).done;)yield S.value}else if(h[Symbol.asyncIterator])for await(let p of h)me(),p?yield*Et(p,g.async||(g.async={})):yield f.encode(p);else yield h}}}useBuffer(e){_=e,z=new DataView(_.buffer,_.byteOffset,_.byteLength),c=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let t=this.structures.slice(0),n=new lr(t,this.sharedValues,this.sharedVersion),i=this.saveShared(n,s=>(s&&s.version||0)==e);return i===!1?(n=this.getShared()||{},this.structures=n.structures||[],this.sharedValues=n.packedValues,this.sharedVersion=n.version,this.structures.nextId=this.structures.length):t.forEach((s,a)=>this.structures[a]=s),i}};function Os(r,e){r<24?_[c++]=e|r:r<256?(_[c++]=e|24,_[c++]=r):r<65536?(_[c++]=e|25,_[c++]=r>>8,_[c++]=r&255):(_[c++]=e|26,z.setUint32(c,r),c+=4)}var lr=class{constructor(e,t,n){this.structures=e,this.packedValues=t,this.version=n}};function Oe(r){r<24?_[c++]=128|r:r<256?(_[c++]=152,_[c++]=r):r<65536?(_[c++]=153,_[c++]=r>>8,_[c++]=r&255):(_[c++]=154,z.setUint32(c,r),c+=4)}var Vi=typeof Blob>"u"?function(){}:Blob;function _n(r){if(r instanceof Vi)return!0;let e=r[Symbol.toStringTag];return e==="Blob"||e==="File"}function or(r,e){switch(typeof r){case"string":if(r.length>3){if(e.objectMap[r]>-1||e.values.length>=e.maxValues)return;let n=e.get(r);if(n)++n.count==2&&e.values.push(r);else if(e.set(r,{count:1}),e.samplingPackedValues){let i=e.samplingPackedValues.get(r);i?i.count++:e.samplingPackedValues.set(r,{count:1})}}break;case"object":if(r)if(r instanceof Array)for(let n=0,i=r.length;n<i;n++)or(r[n],e);else{let n=!e.encoder.useRecords;for(var t in r)r.hasOwnProperty(t)&&(n&&or(t,e),or(r[t],e))}break;case"function":console.log(r)}}var ji=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;As=[Date,Set,Error,RegExp,xe,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,lr];bn=[{tag:1,encode(r,e){let t=r.getTime()/1e3;(this.useTimestamp32||r.getMilliseconds()===0)&&t>=0&&t<4294967296?(_[c++]=26,z.setUint32(c,t),c+=4):(_[c++]=251,z.setFloat64(c,t),c+=8)}},{tag:258,encode(r,e){let t=Array.from(r);e(t)}},{tag:27,encode(r,e){e([r.name,r.message])}},{tag:27,encode(r,e){e(["RegExp",r.source,r.flags])}},{getTag(r){return r.tag},encode(r,e){e(r.value)}},{encode(r,e,t){gn(r,t)}},{getTag(r){if(r.constructor===Uint8Array&&(this.tagUint8Array||Tt&&this.tagUint8Array!==!1))return 64},encode(r,e,t){gn(r,t)}},Se(68,1),Se(69,2),Se(70,4),Se(71,8),Se(72,1),Se(77,2),Se(78,4),Se(79,8),Se(85,4),Se(86,8),{encode(r,e){let t=r.packedValues||[],n=r.structures||[];if(t.values.length>0){_[c++]=216,_[c++]=51,Oe(4);let i=t.values;e(i),Oe(0),Oe(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let s=0,a=i.length;s<a;s++)packedObjectMap[i[s]]=s}if(n){z.setUint32(c,3655335424),c+=3;let i=n.slice(0);i.unshift(57344),i.push(new xe(r.version,1399353956)),e(i)}else e(new xe(r.version,1399353956))}}];function Se(r,e){return!ji&&e>1&&(r-=4),{tag:r,encode:function(n,i){let s=n.byteLength,a=n.byteOffset||0,l=n.buffer||n;i(Tt?fr.from(l,a,s):new Uint8Array(l,a,s))}}}function gn(r,e){let t=r.byteLength;t<24?_[c++]=64+t:t<256?(_[c++]=88,_[c++]=t):t<65536?(_[c++]=89,_[c++]=t>>8,_[c++]=t&255):(_[c++]=90,z.setUint32(c,t),c+=4),c+t>=_.length&&e(c+t),_.set(r.buffer?r:new Uint8Array(r),c),c+=t}function Gi(r,e){let t,n=e.length*2,i=r.length-n;e.sort((s,a)=>s.offset>a.offset?1:-1);for(let s=0;s<e.length;s++){let a=e[s];a.id=s;for(let l of a.references)r[l++]=s>>8,r[l]=s&255}for(;t=e.pop();){let s=t.offset;r.copyWithin(s+n,s,i),n-=2;let a=s+n;r[a++]=216,r[a++]=28,i=s}return r}function Is(r,e){z.setUint32(Z.position+r,c-Z.position-r+1);let t=Z;Z=null,e(t[0]),e(t[1])}var xn=new Nt({useRecords:!1}),cr=xn.encode,Wi=xn.encodeAsIterable,zi=xn.encodeAsAsyncIterable,{NEVER:Yi,ALWAYS:Hi,DECIMAL_ROUND:Ki,DECIMAL_FIT:qi}=ir,mn=512,Xi=1024,wn=2048;var En=class{buffer;ctrl;len;data;maxData;constructor(e){this.buffer=e,this.ctrl=new Int32Array(this.buffer,0,2),this.len=new Int32Array(this.buffer,4,1),this.data=new Uint8Array(this.buffer,8),this.maxData=this.buffer.byteLength-8-16}respond(e){let t;if(e instanceof Uint8Array){let n=Math.min(e.length,this.maxData);t=cr(e.slice(0,n))}else t=cr(e);this.len[0]=t.length,this.data.set(t,0),Atomics.store(this.ctrl,0,1),Atomics.notify(this.ctrl,0)}call(e,t){return this.ctrl[0]=0,t.method=e,postMessage(t),Atomics.wait(this.ctrl,0,0),hn(this.data.slice(0,this.len[0]))}};var x={};tn(x,{ADVICE_DONTNEED:()=>Xo,ADVICE_NOREUSE:()=>$o,ADVICE_NORMAL:()=>Yo,ADVICE_RANDOM:()=>Ko,ADVICE_SEQUENTIAL:()=>Ho,ADVICE_WILLNEED:()=>qo,CLOCKID_MONOTONIC:()=>Ct,CLOCKID_PROCESS_CPUTIME_ID:()=>Qi,CLOCKID_REALTIME:()=>vt,CLOCKID_THREAD_CPUTIME_ID:()=>ea,Ciovec:()=>ot,Dirent:()=>ur,ERRNO_2BIG:()=>ta,ERRNO_ACCES:()=>ra,ERRNO_ADDRINUSE:()=>na,ERRNO_ADDRNOTAVAIL:()=>sa,ERRNO_AFNOSUPPORT:()=>ia,ERRNO_AGAIN:()=>aa,ERRNO_ALREADY:()=>oa,ERRNO_BADF:()=>B,ERRNO_BADMSG:()=>la,ERRNO_BUSY:()=>fa,ERRNO_CANCELED:()=>ca,ERRNO_CHILD:()=>ua,ERRNO_CONNABORTED:()=>da,ERRNO_CONNREFUSED:()=>ha,ERRNO_CONNRESET:()=>pa,ERRNO_DEADLK:()=>ya,ERRNO_DESTADDRREQ:()=>_a,ERRNO_DOM:()=>wa,ERRNO_DQUOT:()=>ba,ERRNO_EXIST:()=>Ns,ERRNO_FAULT:()=>ga,ERRNO_FBIG:()=>ma,ERRNO_HOSTUNREACH:()=>xa,ERRNO_IDRM:()=>Ea,ERRNO_ILSEQ:()=>Ra,ERRNO_INPROGRESS:()=>Sa,ERRNO_INTR:()=>Oa,ERRNO_INVAL:()=>ke,ERRNO_IO:()=>Ia,ERRNO_ISCONN:()=>Aa,ERRNO_ISDIR:()=>Ts,ERRNO_LOOP:()=>Na,ERRNO_MFILE:()=>Ta,ERRNO_MLINK:()=>Da,ERRNO_MSGSIZE:()=>Ua,ERRNO_MULTIHOP:()=>va,ERRNO_NAMETOOLONG:()=>Rn,ERRNO_NETDOWN:()=>Ca,ERRNO_NETRESET:()=>ka,ERRNO_NETUNREACH:()=>Pa,ERRNO_NFILE:()=>Fa,ERRNO_NOBUFS:()=>La,ERRNO_NODEV:()=>Ba,ERRNO_NOENT:()=>Ds,ERRNO_NOEXEC:()=>Ma,ERRNO_NOLCK:()=>Va,ERRNO_NOLINK:()=>ja,ERRNO_NOMEM:()=>Ga,ERRNO_NOMSG:()=>Wa,ERRNO_NOPROTOOPT:()=>za,ERRNO_NOSPC:()=>Ya,ERRNO_NOSYS:()=>Sn,ERRNO_NOTCAPABLE:()=>vs,ERRNO_NOTCONN:()=>Ha,ERRNO_NOTDIR:()=>pr,ERRNO_NOTEMPTY:()=>Us,ERRNO_NOTRECOVERABLE:()=>Ka,ERRNO_NOTSOCK:()=>qa,ERRNO_NOTSUP:()=>W,ERRNO_NOTTY:()=>Xa,ERRNO_NXIO:()=>$a,ERRNO_OVERFLOW:()=>Ja,ERRNO_OWNERDEAD:()=>Za,ERRNO_PERM:()=>kt,ERRNO_PIPE:()=>Qa,ERRNO_PROTO:()=>eo,ERRNO_PROTONOSUPPORT:()=>to,ERRNO_PROTOTYPE:()=>ro,ERRNO_RANGE:()=>no,ERRNO_ROFS:()=>so,ERRNO_SPIPE:()=>io,ERRNO_SRCH:()=>ao,ERRNO_STALE:()=>oo,ERRNO_SUCCESS:()=>K,ERRNO_TIMEDOUT:()=>lo,ERRNO_TXTBSY:()=>fo,ERRNO_XDEV:()=>co,EVENTRWFLAGS_FD_READWRITE_HANGUP:()=>ol,EVENTTYPE_CLOCK:()=>On,EVENTTYPE_FD_READ:()=>il,EVENTTYPE_FD_WRITE:()=>al,Event:()=>Ut,FDFLAGS_APPEND:()=>br,FDFLAGS_DSYNC:()=>Jo,FDFLAGS_NONBLOCK:()=>Zo,FDFLAGS_RSYNC:()=>Qo,FDFLAGS_SYNC:()=>el,FD_STDERR:()=>Zi,FD_STDIN:()=>$i,FD_STDOUT:()=>Ji,FILETYPE_BLOCK_DEVICE:()=>jo,FILETYPE_CHARACTER_DEVICE:()=>wr,FILETYPE_DIRECTORY:()=>Cs,FILETYPE_REGULAR_FILE:()=>Ft,FILETYPE_SOCKET_DGRAM:()=>Go,FILETYPE_SOCKET_STREAM:()=>Wo,FILETYPE_SYMBOLIC_LINK:()=>zo,FILETYPE_UNKNOWN:()=>Vo,FSTFLAGS_ATIM:()=>tl,FSTFLAGS_ATIM_NOW:()=>rl,FSTFLAGS_MTIM:()=>nl,FSTFLAGS_MTIM_NOW:()=>sl,Fdstat:()=>We,Filestat:()=>ze,Iovec:()=>at,OFLAGS_CREAT:()=>ks,OFLAGS_DIRECTORY:()=>Ps,OFLAGS_EXCL:()=>Fs,OFLAGS_TRUNC:()=>Lt,PREOPENTYPE_DIR:()=>Ls,Prestat:()=>hr,PrestatDir:()=>dr,RIFLAGS_RECV_PEEK:()=>Ml,RIFLAGS_RECV_WAITALL:()=>Vl,RIGHTS_FD_ADVISE:()=>bo,RIGHTS_FD_ALLOCATE:()=>go,RIGHTS_FD_DATASYNC:()=>uo,RIGHTS_FD_FDSTAT_SET_FLAGS:()=>yo,RIGHTS_FD_FILESTAT_GET:()=>vo,RIGHTS_FD_FILESTAT_SET_SIZE:()=>Co,RIGHTS_FD_FILESTAT_SET_TIMES:()=>ko,RIGHTS_FD_READ:()=>ho,RIGHTS_FD_READDIR:()=>Oo,RIGHTS_FD_SEEK:()=>po,RIGHTS_FD_SYNC:()=>_o,RIGHTS_FD_TELL:()=>wo,RIGHTS_FD_WRITE:()=>lt,RIGHTS_PATH_CREATE_DIRECTORY:()=>mo,RIGHTS_PATH_CREATE_FILE:()=>xo,RIGHTS_PATH_FILESTAT_GET:()=>To,RIGHTS_PATH_FILESTAT_SET_SIZE:()=>Do,RIGHTS_PATH_FILESTAT_SET_TIMES:()=>Uo,RIGHTS_PATH_LINK_SOURCE:()=>Eo,RIGHTS_PATH_LINK_TARGET:()=>Ro,RIGHTS_PATH_OPEN:()=>So,RIGHTS_PATH_READLINK:()=>Io,RIGHTS_PATH_REMOVE_DIRECTORY:()=>Fo,RIGHTS_PATH_RENAME_SOURCE:()=>Ao,RIGHTS_PATH_RENAME_TARGET:()=>No,RIGHTS_PATH_SYMLINK:()=>Po,RIGHTS_PATH_UNLINK_FILE:()=>Lo,RIGHTS_POLL_FD_READWRITE:()=>Bo,RIGHTS_SOCK_SHUTDOWN:()=>Mo,ROFLAGS_RECV_DATA_TRUNCATED:()=>jl,SDFLAGS_RD:()=>Gl,SDFLAGS_WR:()=>Wl,SIGNAL_ABRT:()=>pl,SIGNAL_ALRM:()=>El,SIGNAL_BUS:()=>yl,SIGNAL_CHLD:()=>Sl,SIGNAL_CONT:()=>Ol,SIGNAL_FPE:()=>_l,SIGNAL_HUP:()=>fl,SIGNAL_ILL:()=>dl,SIGNAL_INT:()=>cl,SIGNAL_KILL:()=>wl,SIGNAL_NONE:()=>ll,SIGNAL_PIPE:()=>xl,SIGNAL_POLL:()=>Fl,SIGNAL_PROF:()=>kl,SIGNAL_PWR:()=>Ll,SIGNAL_QUIT:()=>ul,SIGNAL_SEGV:()=>gl,SIGNAL_STOP:()=>Il,SIGNAL_SYS:()=>Bl,SIGNAL_TERM:()=>Rl,SIGNAL_TRAP:()=>hl,SIGNAL_TSTP:()=>Al,SIGNAL_TTIN:()=>Nl,SIGNAL_TTOU:()=>Tl,SIGNAL_URG:()=>Dl,SIGNAL_USR1:()=>bl,SIGNAL_USR2:()=>ml,SIGNAL_VTALRM:()=>Cl,SIGNAL_WINCH:()=>Pl,SIGNAL_XCPU:()=>Ul,SIGNAL_XFSZ:()=>vl,SUBCLOCKFLAGS_SUBSCRIPTION_CLOCK_ABSTIME:()=>In,Subscription:()=>Dt,WHENCE_CUR:()=>_r,WHENCE_END:()=>Pt,WHENCE_SET:()=>yr});var $i=0,Ji=1,Zi=2,vt=0,Ct=1,Qi=2,ea=3,K=0,ta=1,ra=2,na=3,sa=4,ia=5,aa=6,oa=7,B=8,la=9,fa=10,ca=11,ua=12,da=13,ha=14,pa=15,ya=16,_a=17,wa=18,ba=19,Ns=20,ga=21,ma=22,xa=23,Ea=24,Ra=25,Sa=26,Oa=27,ke=28,Ia=29,Aa=30,Ts=31,Na=32,Ta=33,Da=34,Ua=35,va=36,Rn=37,Ca=38,ka=39,Pa=40,Fa=41,La=42,Ba=43,Ds=44,Ma=45,Va=46,ja=47,Ga=48,Wa=49,za=50,Ya=51,Sn=52,Ha=53,pr=54,Us=55,Ka=56,qa=57,W=58,Xa=59,$a=60,Ja=61,Za=62,kt=63,Qa=64,eo=65,to=66,ro=67,no=68,so=69,io=70,ao=71,oo=72,lo=73,fo=74,co=75,vs=76,uo=1,ho=2,po=4,yo=8,_o=16,wo=32,lt=64,bo=128,go=256,mo=512,xo=1024,Eo=2048,Ro=4096,So=8192,Oo=16384,Io=32768,Ao=65536,No=131072,To=262144,Do=524288,Uo=1048576,vo=2097152,Co=4194304,ko=8388608,Po=16777216,Fo=33554432,Lo=67108864,Bo=134217728,Mo=268435456,at=class r{static read_bytes(e,t){let n=new r;return n.buf=e.getUint32(t,!0),n.buf_len=e.getUint32(t+4,!0),n}static read_bytes_array(e,t,n){let i=[];for(let s=0;s<n;s++)i.push(r.read_bytes(e,t+8*s));return i}},ot=class r{static read_bytes(e,t){let n=new r;return n.buf=e.getUint32(t,!0),n.buf_len=e.getUint32(t+4,!0),n}static read_bytes_array(e,t,n){let i=[];for(let s=0;s<n;s++)i.push(r.read_bytes(e,t+8*s));return i}},yr=0,_r=1,Pt=2,Vo=0,jo=1,wr=2,Cs=3,Ft=4,Go=5,Wo=6,zo=7,ur=class{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,t){e.setBigUint64(t,this.d_next,!0),e.setBigUint64(t+8,this.d_ino,!0),e.setUint32(t+16,this.dir_name.length,!0),e.setUint8(t+20,this.d_type)}write_name_bytes(e,t,n){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,n)),t)}constructor(e,t,n,i){let s=new TextEncoder().encode(n);this.d_next=e,this.d_ino=t,this.d_namlen=s.byteLength,this.d_type=i,this.dir_name=s}},Yo=0,Ho=1,Ko=2,qo=3,Xo=4,$o=5,br=1,Jo=2,Zo=4,Qo=8,el=16,We=class{write_bytes(e,t){e.setUint8(t,this.fs_filetype),e.setUint16(t+2,this.fs_flags,!0),e.setBigUint64(t+8,this.fs_rights_base,!0),e.setBigUint64(t+16,this.fs_rights_inherited,!0)}constructor(e,t){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=t}},tl=1,rl=2,nl=4,sl=8,ks=1,Ps=2,Fs=4,Lt=8,ze=class{write_bytes(e,t){e.setBigUint64(t,this.dev,!0),e.setBigUint64(t+8,this.ino,!0),e.setUint8(t+16,this.filetype),e.setBigUint64(t+24,this.nlink,!0),e.setBigUint64(t+32,this.size,!0),e.setBigUint64(t+38,this.atim,!0),e.setBigUint64(t+46,this.mtim,!0),e.setBigUint64(t+52,this.ctim,!0)}constructor(e,t,n){this.dev=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.ino=e,this.filetype=t,this.size=n}},On=0,il=1,al=2,ol=1,In=1,Dt=class r{static read_bytes(e,t){return new r(e.getBigUint64(t,!0),e.getUint8(t+8),e.getUint32(t+16,!0),e.getBigUint64(t+24,!0),e.getUint16(t+36,!0))}constructor(e,t,n,i,s){this.userdata=e,this.eventtype=t,this.clockid=n,this.timeout=i,this.flags=s}},Ut=class{write_bytes(e,t){e.setBigUint64(t,this.userdata,!0),e.setUint16(t+8,this.error,!0),e.setUint8(t+10,this.eventtype)}constructor(e,t,n){this.userdata=e,this.error=t,this.eventtype=n}},ll=0,fl=1,cl=2,ul=3,dl=4,hl=5,pl=6,yl=7,_l=8,wl=9,bl=10,gl=11,ml=12,xl=13,El=14,Rl=15,Sl=16,Ol=17,Il=18,Al=19,Nl=20,Tl=21,Dl=22,Ul=23,vl=24,Cl=25,kl=26,Pl=27,Fl=28,Ll=29,Bl=30,Ml=1,Vl=2,jl=1,Gl=1,Wl=2,Ls=0,dr=class{write_bytes(e,t){e.setUint32(t,this.pr_name.byteLength,!0)}constructor(e){this.pr_name=new TextEncoder().encode(e)}},hr=class r{static dir(e){let t=new r;return t.tag=Ls,t.inner=new dr(e),t}write_bytes(e,t){e.setUint32(t,this.tag,!0),this.inner.write_bytes(e,t+4)}};var zl=class{enable(e){this.log=Yl(e===void 0?!0:e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}};function Yl(r,e){return r?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}var he=new zl(!1);var ft=class extends Error{constructor(e){super("exit with exit code "+e),this.code=e}},Bs=class{start(e){this.inst=e;try{return e.exports._start(),0}catch(t){if(t instanceof ft)return t.code;throw t}}initialize(e){this.inst=e,e.exports._initialize&&e.exports._initialize()}constructor(e,t,n,i={}){this.args=[],this.env=[],this.fds=[],he.enable(i.debug),this.args=e,this.env=t,this.fds=n;let s=this;this.wasiImport={args_sizes_get(a,l){let d=new DataView(s.inst.exports.memory.buffer);d.setUint32(a,s.args.length,!0);let f=0;for(let m of s.args)f+=m.length+1;return d.setUint32(l,f,!0),he.log(d.getUint32(a,!0),d.getUint32(l,!0)),0},args_get(a,l){let d=new DataView(s.inst.exports.memory.buffer),f=new Uint8Array(s.inst.exports.memory.buffer),m=l;for(let b=0;b<s.args.length;b++){d.setUint32(a,l,!0),a+=4;let A=new TextEncoder().encode(s.args[b]);f.set(A,l),d.setUint8(l+A.length,0),l+=A.length+1}return he.enabled&&he.log(new TextDecoder("utf-8").decode(f.slice(m,l))),0},environ_sizes_get(a,l){let d=new DataView(s.inst.exports.memory.buffer);d.setUint32(a,s.env.length,!0);let f=0;for(let m of s.env)f+=new TextEncoder().encode(m).length+1;return d.setUint32(l,f,!0),he.log(d.getUint32(a,!0),d.getUint32(l,!0)),0},environ_get(a,l){let d=new DataView(s.inst.exports.memory.buffer),f=new Uint8Array(s.inst.exports.memory.buffer),m=l;for(let b=0;b<s.env.length;b++){d.setUint32(a,l,!0),a+=4;let A=new TextEncoder().encode(s.env[b]);f.set(A,l),d.setUint8(l+A.length,0),l+=A.length+1}return he.enabled&&he.log(new TextDecoder("utf-8").decode(f.slice(m,l))),0},clock_res_get(a,l){let d;switch(a){case 1:{d=5000n;break}case 0:{d=1000000n;break}default:return 52}return new DataView(s.inst.exports.memory.buffer).setBigUint64(l,d,!0),0},clock_time_get(a,l,d){let f=new DataView(s.inst.exports.memory.buffer);if(a===0)f.setBigUint64(d,BigInt(new Date().getTime())*1000000n,!0);else if(a==1){let m;try{m=BigInt(Math.round(performance.now()*1e6))}catch{m=0n}f.setBigUint64(d,m,!0)}else f.setBigUint64(d,0n,!0);return 0},fd_advise(a,l,d,f){return s.fds[a]!=null?0:8},fd_allocate(a,l,d){return s.fds[a]!=null?s.fds[a].fd_allocate(l,d):8},fd_close(a){if(s.fds[a]!=null){let l=s.fds[a].fd_close();return s.fds[a]=void 0,l}else return 8},fd_datasync(a){return s.fds[a]!=null?s.fds[a].fd_sync():8},fd_fdstat_get(a,l){if(s.fds[a]!=null){let{ret:d,fdstat:f}=s.fds[a].fd_fdstat_get();return f?.write_bytes(new DataView(s.inst.exports.memory.buffer),l),d}else return 8},fd_fdstat_set_flags(a,l){return s.fds[a]!=null?s.fds[a].fd_fdstat_set_flags(l):8},fd_fdstat_set_rights(a,l,d){return s.fds[a]!=null?s.fds[a].fd_fdstat_set_rights(l,d):8},fd_filestat_get(a,l){if(s.fds[a]!=null){let{ret:d,filestat:f}=s.fds[a].fd_filestat_get();return f?.write_bytes(new DataView(s.inst.exports.memory.buffer),l),d}else return 8},fd_filestat_set_size(a,l){return s.fds[a]!=null?s.fds[a].fd_filestat_set_size(l):8},fd_filestat_set_times(a,l,d,f){return s.fds[a]!=null?s.fds[a].fd_filestat_set_times(l,d,f):8},fd_pread(a,l,d,f,m){let b=new DataView(s.inst.exports.memory.buffer),A=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let O=at.read_bytes_array(b,l,d),T=0;for(let U of O){let{ret:F,data:L}=s.fds[a].fd_pread(U.buf_len,f);if(F!=0)return b.setUint32(m,T,!0),F;if(A.set(L,U.buf),T+=L.length,f+=BigInt(L.length),L.length!=U.buf_len)break}return b.setUint32(m,T,!0),0}else return 8},fd_prestat_get(a,l){let d=new DataView(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let{ret:f,prestat:m}=s.fds[a].fd_prestat_get();return m?.write_bytes(d,l),f}else return 8},fd_prestat_dir_name(a,l,d){if(s.fds[a]!=null){let{ret:f,prestat:m}=s.fds[a].fd_prestat_get();if(m==null)return f;let b=m.inner.pr_name;return new Uint8Array(s.inst.exports.memory.buffer).set(b.slice(0,d),l),b.byteLength>d?37:0}else return 8},fd_pwrite(a,l,d,f,m){let b=new DataView(s.inst.exports.memory.buffer),A=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let O=ot.read_bytes_array(b,l,d),T=0;for(let U of O){let F=A.slice(U.buf,U.buf+U.buf_len),{ret:L,nwritten:se}=s.fds[a].fd_pwrite(F,f);if(L!=0)return b.setUint32(m,T,!0),L;if(T+=se,f+=BigInt(se),se!=F.byteLength)break}return b.setUint32(m,T,!0),0}else return 8},fd_read(a,l,d,f){let m=new DataView(s.inst.exports.memory.buffer),b=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let A=at.read_bytes_array(m,l,d),O=0;for(let T of A){let{ret:U,data:F}=s.fds[a].fd_read(T.buf_len);if(U!=0)return m.setUint32(f,O,!0),U;if(b.set(F,T.buf),O+=F.length,F.length!=T.buf_len)break}return m.setUint32(f,O,!0),0}else return 8},fd_readdir(a,l,d,f,m){let b=new DataView(s.inst.exports.memory.buffer),A=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let O=0;for(;;){let{ret:T,dirent:U}=s.fds[a].fd_readdir_single(f);if(T!=0)return b.setUint32(m,O,!0),T;if(U==null)break;if(d-O<U.head_length()){O=d;break}let F=new ArrayBuffer(U.head_length());if(U.write_head_bytes(new DataView(F),0),A.set(new Uint8Array(F).slice(0,Math.min(F.byteLength,d-O)),l),l+=U.head_length(),O+=U.head_length(),d-O<U.name_length()){O=d;break}U.write_name_bytes(A,l,d-O),l+=U.name_length(),O+=U.name_length(),f=U.d_next}return b.setUint32(m,O,!0),0}else return 8},fd_renumber(a,l){if(s.fds[a]!=null&&s.fds[l]!=null){let d=s.fds[l].fd_close();return d!=0?d:(s.fds[l]=s.fds[a],s.fds[a]=void 0,0)}else return 8},fd_seek(a,l,d,f){let m=new DataView(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let{ret:b,offset:A}=s.fds[a].fd_seek(l,d);return m.setBigInt64(f,A,!0),b}else return 8},fd_sync(a){return s.fds[a]!=null?s.fds[a].fd_sync():8},fd_tell(a,l){let d=new DataView(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let{ret:f,offset:m}=s.fds[a].fd_tell();return d.setBigUint64(l,m,!0),f}else return 8},fd_write(a,l,d,f){let m=new DataView(s.inst.exports.memory.buffer),b=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let A=ot.read_bytes_array(m,l,d),O=0;for(let T of A){let U=b.slice(T.buf,T.buf+T.buf_len),{ret:F,nwritten:L}=s.fds[a].fd_write(U);if(F!=0)return m.setUint32(f,O,!0),F;if(O+=L,L!=U.byteLength)break}return m.setUint32(f,O,!0),0}else return 8},path_create_directory(a,l,d){let f=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let m=new TextDecoder("utf-8").decode(f.slice(l,l+d));return s.fds[a].path_create_directory(m)}else return 8},path_filestat_get(a,l,d,f,m){let b=new DataView(s.inst.exports.memory.buffer),A=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let O=new TextDecoder("utf-8").decode(A.slice(d,d+f)),{ret:T,filestat:U}=s.fds[a].path_filestat_get(l,O);return U?.write_bytes(b,m),T}else return 8},path_filestat_set_times(a,l,d,f,m,b,A){let O=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let T=new TextDecoder("utf-8").decode(O.slice(d,d+f));return s.fds[a].path_filestat_set_times(l,T,m,b,A)}else return 8},path_link(a,l,d,f,m,b,A){let O=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null&&s.fds[m]!=null){let T=new TextDecoder("utf-8").decode(O.slice(d,d+f)),U=new TextDecoder("utf-8").decode(O.slice(b,b+A)),{ret:F,inode_obj:L}=s.fds[a].path_lookup(T,l);return L==null?F:s.fds[m].path_link(U,L,!1)}else return 8},path_open(a,l,d,f,m,b,A,O,T){let U=new DataView(s.inst.exports.memory.buffer),F=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let L=new TextDecoder("utf-8").decode(F.slice(d,d+f));he.log(L);let{ret:se,fd_obj:le}=s.fds[a].path_open(l,L,m,b,A,O);if(se!=0)return se;s.fds.push(le);let v=s.fds.length-1;return U.setUint32(T,v,!0),0}else return 8},path_readlink(a,l,d,f,m,b){let A=new DataView(s.inst.exports.memory.buffer),O=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let T=new TextDecoder("utf-8").decode(O.slice(l,l+d));he.log(T);let{ret:U,data:F}=s.fds[a].path_readlink(T);if(F!=null){let L=new TextEncoder().encode(F);if(L.length>m)return A.setUint32(b,0,!0),8;O.set(L,f),A.setUint32(b,L.length,!0)}return U}else return 8},path_remove_directory(a,l,d){let f=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let m=new TextDecoder("utf-8").decode(f.slice(l,l+d));return s.fds[a].path_remove_directory(m)}else return 8},path_rename(a,l,d,f,m,b){let A=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null&&s.fds[f]!=null){let O=new TextDecoder("utf-8").decode(A.slice(l,l+d)),T=new TextDecoder("utf-8").decode(A.slice(m,m+b)),{ret:U,inode_obj:F}=s.fds[a].path_unlink(O);if(F==null)return U;if(U=s.fds[f].path_link(T,F,!0),U!=0&&s.fds[a].path_link(O,F,!0)!=0)throw"path_link should always return success when relinking an inode back to the original place";return U}else return 8},path_symlink(a,l,d,f,m){let b=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[d]!=null){let A=new TextDecoder("utf-8").decode(b.slice(a,a+l)),O=new TextDecoder("utf-8").decode(b.slice(f,f+m));return 58}else return 8},path_unlink_file(a,l,d){let f=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let m=new TextDecoder("utf-8").decode(f.slice(l,l+d));return s.fds[a].path_unlink_file(m)}else return 8},poll_oneoff(a,l,d){if(d===0)return 28;if(d>1)return he.log("poll_oneoff: only a single subscription is supported"),58;let f=new DataView(s.inst.exports.memory.buffer),m=Dt.read_bytes(f,a),b=m.eventtype,A=m.clockid,O=m.timeout;if(b!==On)return he.log("poll_oneoff: only clock subscriptions are supported"),58;let T;if(A===1)T=()=>BigInt(Math.round(performance.now()*1e6));else if(A===0)T=()=>BigInt(new Date().getTime())*1000000n;else return 28;let U=(m.flags&In)!==0?O:T()+O;for(;U>T(););return new Ut(m.userdata,0,b).write_bytes(f,l),0},proc_exit(a){throw new ft(a)},proc_raise(a){throw"raised signal "+a},sched_yield(){},random_get(a,l){let d=new Uint8Array(s.inst.exports.memory.buffer).subarray(a,a+l);if("crypto"in globalThis&&(typeof SharedArrayBuffer>"u"||!(s.inst.exports.memory.buffer instanceof SharedArrayBuffer)))for(let f=0;f<l;f+=65536)crypto.getRandomValues(d.subarray(f,f+65536));else for(let f=0;f<l;f++)d[f]=Math.random()*256|0},sock_recv(a,l,d){throw"sockets not supported"},sock_send(a,l,d){throw"sockets not supported"},sock_shutdown(a,l){throw"sockets not supported"},sock_accept(a,l){throw"sockets not supported"}}}};var Ie=class{fd_allocate(e,t){return 58}fd_close(){return 0}fd_fdstat_get(){return{ret:58,fdstat:null}}fd_fdstat_set_flags(e){return 58}fd_fdstat_set_rights(e,t){return 58}fd_filestat_get(){return{ret:58,filestat:null}}fd_filestat_set_size(e){return 58}fd_filestat_set_times(e,t,n){return 58}fd_pread(e,t){return{ret:58,data:new Uint8Array}}fd_prestat_get(){return{ret:58,prestat:null}}fd_pwrite(e,t){return{ret:58,nwritten:0}}fd_read(e){return{ret:58,data:new Uint8Array}}fd_readdir_single(e){return{ret:58,dirent:null}}fd_seek(e,t){return{ret:58,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:58,offset:0n}}fd_write(e){return{ret:58,nwritten:0}}path_create_directory(e){return 58}path_filestat_get(e,t){return{ret:58,filestat:null}}path_filestat_set_times(e,t,n,i,s){return 58}path_link(e,t,n){return 58}path_unlink(e){return{ret:58,inode_obj:null}}path_lookup(e,t){return{ret:58,inode_obj:null}}path_open(e,t,n,i,s,a){return{ret:54,fd_obj:null}}path_readlink(e){return{ret:58,data:null}}path_remove_directory(e){return 58}path_rename(e,t,n){return 58}path_unlink_file(e){return 58}},pe=class r{static issue_ino(){return r.next_ino++}static root_ino(){return 0n}constructor(){this.ino=r.issue_ino()}};pe.next_ino=1n;var ct=class extends Ie{fd_allocate(e,t){if(!(this.file.size>e+t)){let n=new Uint8Array(Number(e+t));n.set(this.file.data,0),this.file.data=n}return 0}fd_fdstat_get(){return{ret:0,fdstat:new We(Ft,0)}}fd_filestat_set_size(e){if(this.file.size>e)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(e)));else{let t=new Uint8Array(Number(e));t.set(this.file.data,0),this.file.data=t}return 0}fd_read(e){let t=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(e)));return this.file_pos+=BigInt(t.length),{ret:0,data:t}}fd_pread(e,t){return{ret:0,data:this.file.data.slice(Number(t),Number(t+BigInt(e)))}}fd_seek(e,t){let n;switch(t){case yr:n=e;break;case _r:n=this.file_pos+e;break;case Pt:n=BigInt(this.file.data.byteLength)+e;break;default:return{ret:28,offset:0n}}return n<0?{ret:28,offset:0n}:(this.file_pos=n,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(e){if(this.file.readonly)return{ret:8,nwritten:0};if(this.file_pos+BigInt(e.byteLength)>this.file.size){let t=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(t)}return this.file.data.set(e,Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),{ret:0,nwritten:e.byteLength}}fd_pwrite(e,t){if(this.file.readonly)return{ret:8,nwritten:0};if(t+BigInt(e.byteLength)>this.file.size){let n=this.file.data;this.file.data=new Uint8Array(Number(t+BigInt(e.byteLength))),this.file.data.set(n)}return this.file.data.set(e,Number(t)),{ret:0,nwritten:e.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}};var Bt=class extends pe{path_open(e,t,n){if(this.readonly&&(t&BigInt(64))==BigInt(64))return{ret:63,fd_obj:null};if((e&Lt)==Lt){if(this.readonly)return{ret:63,fd_obj:null};this.data=new Uint8Array([])}let i=new ct(this);return n&br&&i.fd_seek(0n,Pt),{ret:0,fd_obj:i}}get size(){return BigInt(this.data.byteLength)}stat(){return new ze(this.ino,Ft,this.size)}constructor(e,t){super(),this.data=new Uint8Array(e),this.readonly=!!t?.readonly}};var gr=class r extends Ie{fd_filestat_get(){return{ret:0,filestat:new ze(this.ino,wr,BigInt(0))}}fd_fdstat_get(){let e=new We(wr,0);return e.fs_rights_base=BigInt(64),{ret:0,fdstat:e}}fd_write(e){return this.write(e),{ret:0,nwritten:e.byteLength}}static lineBuffered(e){let t=new TextDecoder("utf-8",{fatal:!1}),n="";return new r(i=>{n+=t.decode(i,{stream:!0});let s=n.split(`
`);for(let[a,l]of s.entries())a<s.length-1?e(l):n=l})}constructor(e){super(),this.ino=pe.issue_ino(),this.write=e}};var Mt=class extends pe{handle;readonly;constructor(e,t){super(),this.handle=e,this.readonly=!!t?.readonly}path_open(e,t,n){if(this.readonly&&(t&BigInt(x.RIGHTS_FD_WRITE))==BigInt(x.RIGHTS_FD_WRITE))return{ret:x.ERRNO_PERM,fd_obj:null};if((e&x.OFLAGS_TRUNC)==x.OFLAGS_TRUNC){if(this.readonly)return{ret:x.ERRNO_PERM,fd_obj:null};this.handle.truncate(0)}let i=new ut(this);return n&x.FDFLAGS_APPEND&&i.fd_seek(0n,x.WHENCE_END),{ret:x.ERRNO_SUCCESS,fd_obj:i}}get size(){return BigInt(this.handle.getSize())}stat(){return new x.Filestat(this.ino,x.FILETYPE_REGULAR_FILE,this.size)}},ut=class extends Ie{file;position=0n;ino;constructor(e){super(),this.file=e,this.ino=pe.issue_ino(),this.file.handle.open()}fd_allocate(e,t){return BigInt(this.file.handle.getSize())>e+t||this.file.handle.truncate(Number(e+t)),x.ERRNO_SUCCESS}fd_fdstat_get(){let e=this.file.handle.getSize(),t=new x.Fdstat(e>0?x.FILETYPE_REGULAR_FILE:x.FILETYPE_CHARACTER_DEVICE,0);return this.file.readonly||(t.fs_rights_base=BigInt(x.RIGHTS_FD_WRITE)),{ret:0,fdstat:t}}fd_filestat_get(){let e=this.file.handle.getSize();return{ret:0,filestat:new x.Filestat(this.ino,e>0?x.FILETYPE_REGULAR_FILE:x.FILETYPE_CHARACTER_DEVICE,BigInt(e))}}fd_filestat_set_size(e){return this.file.handle.truncate(Number(e)),x.ERRNO_SUCCESS}fd_read(e){let t=new Uint8Array(e),n=this.file.handle.read(t,{at:Number(this.position)});return this.position+=BigInt(n),{ret:0,data:t.slice(0,n)}}fd_seek(e,t){let n;switch(t){case x.WHENCE_SET:n=BigInt(e);break;case x.WHENCE_CUR:n=this.position+BigInt(e);break;case x.WHENCE_END:n=BigInt(this.file.handle.getSize())+BigInt(e);break;default:return{ret:x.ERRNO_INVAL,offset:0n}}return n<0?{ret:x.ERRNO_INVAL,offset:0n}:(this.position=n,{ret:x.ERRNO_SUCCESS,offset:this.position})}fd_write(e){if(this.file.readonly)return{ret:x.ERRNO_BADF,nwritten:0};let t=this.file.handle.write(e,{at:Number(this.position)});return this.position+=BigInt(t),{ret:x.ERRNO_SUCCESS,nwritten:t}}fd_sync(){return this.file.handle.flush(),x.ERRNO_SUCCESS}},mr=class extends Ie{dir;constructor(e){super(),this.dir=e}fd_seek(e,t){return{ret:x.ERRNO_BADF,offset:0n}}fd_tell(){return{ret:x.ERRNO_BADF,offset:0n}}fd_allocate(e,t){return x.ERRNO_BADF}fd_fdstat_get(){return{ret:0,fdstat:new x.Fdstat(x.FILETYPE_DIRECTORY,0)}}fd_readdir_single(e){if(e==0n)return{ret:x.ERRNO_SUCCESS,dirent:new x.Dirent(1n,this.dir.ino,".",x.FILETYPE_DIRECTORY)};if(e==1n)return{ret:x.ERRNO_SUCCESS,dirent:new x.Dirent(2n,this.dir.parent_ino(),"..",x.FILETYPE_DIRECTORY)};if(e>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};let[t,n]=Array.from(this.dir.contents.entries())[Number(e-2n)];return{ret:0,dirent:new x.Dirent(e+1n,n.ino,t,n.stat().filetype)}}path_filestat_get(e,t){let{ret:n,path:i}=Ae.from(t);if(i==null)return{ret:n,filestat:null};let{ret:s,entry:a}=this.dir.get_entry_for_path(i);return a==null?{ret:s,filestat:null}:{ret:0,filestat:a.stat()}}path_lookup(e,t){let{ret:n,path:i}=Ae.from(e);if(i==null)return{ret:n,inode_obj:null};let{ret:s,entry:a}=this.dir.get_entry_for_path(i);return a==null?{ret:s,inode_obj:null}:{ret:x.ERRNO_SUCCESS,inode_obj:a}}path_open(e,t,n,i,s,a){let{ret:l,path:d}=Ae.from(t);if(d==null)return{ret:l,fd_obj:null};let{ret:f,entry:m}=this.dir.get_entry_for_path(d);if(m==null){if(f!=x.ERRNO_NOENT)return{ret:f,fd_obj:null};if((n&x.OFLAGS_CREAT)==x.OFLAGS_CREAT){let{ret:b,entry:A}=this.dir.create_entry_for_path(t,(n&x.OFLAGS_DIRECTORY)==x.OFLAGS_DIRECTORY);if(A==null)return{ret:b,fd_obj:null};m=A}else return{ret:x.ERRNO_NOENT,fd_obj:null}}else if((n&x.OFLAGS_EXCL)==x.OFLAGS_EXCL)return{ret:x.ERRNO_EXIST,fd_obj:null};return(n&x.OFLAGS_DIRECTORY)==x.OFLAGS_DIRECTORY&&m.stat().filetype!==x.FILETYPE_DIRECTORY?{ret:x.ERRNO_NOTDIR,fd_obj:null}:m.path_open(n,i,a)}path_create_directory(e){return this.path_open(0,e,x.OFLAGS_CREAT|x.OFLAGS_DIRECTORY,0n,0n,0).ret}path_link(e,t,n){let{ret:i,path:s}=Ae.from(e);if(s==null)return i;if(s.is_dir)return x.ERRNO_NOENT;let{ret:a,parent_entry:l,filename:d,entry:f}=this.dir.get_parent_dir_and_entry_for_path(s,!0);if(l==null||d==null)return a;if(f!=null){let m=t.stat().filetype==x.FILETYPE_DIRECTORY,b=f.stat().filetype==x.FILETYPE_DIRECTORY;if(m&&b)if(n&&f instanceof Ye){if(f.contents.size!=0)return x.ERRNO_NOTEMPTY}else return x.ERRNO_EXIST;else{if(m&&!b)return x.ERRNO_NOTDIR;if(!m&&b)return x.ERRNO_ISDIR;if(!(t.stat().filetype==x.FILETYPE_REGULAR_FILE&&f.stat().filetype==x.FILETYPE_REGULAR_FILE))return x.ERRNO_EXIST}}return!n&&t.stat().filetype==x.FILETYPE_DIRECTORY?x.ERRNO_PERM:(l.createLink(d,t),x.ERRNO_SUCCESS)}path_unlink(e){let{ret:t,path:n}=Ae.from(e);if(n==null)return{ret:t,inode_obj:null};let{ret:i,parent_entry:s,filename:a,entry:l}=this.dir.get_parent_dir_and_entry_for_path(n,!0);return s==null||a==null?{ret:i,inode_obj:null}:l==null?{ret:x.ERRNO_NOENT,inode_obj:null}:(s.removeEntry(a),{ret:x.ERRNO_SUCCESS,inode_obj:l})}path_unlink_file(e){let{ret:t,path:n}=Ae.from(e);if(n==null)return t;let{ret:i,parent_entry:s,filename:a,entry:l}=this.dir.get_parent_dir_and_entry_for_path(n,!1);return s==null||a==null||l==null?i:l.stat().filetype===x.FILETYPE_DIRECTORY?x.ERRNO_ISDIR:(s.removeEntry(a),x.ERRNO_SUCCESS)}path_remove_directory(e){let{ret:t,path:n}=Ae.from(e);if(n==null)return t;let{ret:i,parent_entry:s,filename:a,entry:l}=this.dir.get_parent_dir_and_entry_for_path(n,!1);return s==null||a==null||l==null?i:!(l instanceof Ye)||l.stat().filetype!==x.FILETYPE_DIRECTORY?x.ERRNO_NOTDIR:(l.syncEntries(),l.contents.size!==0?x.ERRNO_NOTEMPTY:s.removeEntry(a)?x.ERRNO_SUCCESS:x.ERRNO_NOENT)}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(e){return x.ERRNO_BADF}fd_read(e){return{ret:x.ERRNO_BADF,data:new Uint8Array}}fd_pread(e,t){return{ret:x.ERRNO_BADF,data:new Uint8Array}}fd_write(e){return{ret:x.ERRNO_BADF,nwritten:0}}fd_pwrite(e,t){return{ret:x.ERRNO_BADF,nwritten:0}}},An=class extends mr{prestat_name;constructor(e,t){super(t),this.prestat_name=e}fd_prestat_get(){return{ret:0,prestat:x.Prestat.dir(this.prestat_name)}}},Ae=class r{parts=[];is_dir=!1;static from(e){let t=new r;if(t.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:x.ERRNO_NOTCAPABLE,path:null};if(e.includes("\0"))return{ret:x.ERRNO_INVAL,path:null};for(let n of e.split("/"))if(!(n===""||n===".")){if(n===".."){if(t.parts.pop()==null)return{ret:x.ERRNO_NOTCAPABLE,path:null};continue}t.parts.push(n)}return{ret:x.ERRNO_SUCCESS,path:t}}to_path_string(){let e=this.parts.join("/");return this.is_dir&&(e+="/"),e}},Ye=class r extends pe{contents;parent=null;handle;constructor(e){super(),this.handle=e}syncEntries(){this.contents=this.handle.readDir();for(let e of this.contents.values())e instanceof r&&(e.parent=this)}removeEntry(e){return this.handle.removeEntry(e)?this.contents.delete(e):!1}createLink(e,t){this.handle.createLink(e,t)&&this.contents.set(e,t)}createFile(e,t){this.handle.createFile(e,t)&&this.contents.set(e,t)}createDirectory(e,t){this.handle.createDirectory(e,t)&&this.contents.set(e,t)}parent_ino(){return this.parent==null?pe.root_ino():this.parent.ino}path_open(e,t,n){return this.syncEntries(),{ret:x.ERRNO_SUCCESS,fd_obj:new mr(this)}}stat(){return new x.Filestat(this.ino,x.FILETYPE_DIRECTORY,0n)}get_entry_for_path(e){let t=this;for(let n of e.parts){if(!(t instanceof r))return{ret:x.ERRNO_NOTDIR,entry:null};t.syncEntries();let i=t.contents.get(n);if(i!==void 0)t=i;else return{ret:x.ERRNO_NOENT,entry:null}}return e.is_dir&&t.stat().filetype!=x.FILETYPE_DIRECTORY?{ret:x.ERRNO_NOTDIR,entry:null}:{ret:x.ERRNO_SUCCESS,entry:t}}get_parent_dir_and_entry_for_path(e,t){let n=e.parts.pop();if(n===void 0)return{ret:x.ERRNO_INVAL,parent_entry:null,filename:null,entry:null};let{ret:i,entry:s}=this.get_entry_for_path(e);if(s==null)return{ret:i,parent_entry:null,filename:null,entry:null};if(!(s instanceof r))return{ret:x.ERRNO_NOTDIR,parent_entry:null,filename:null,entry:null};s.syncEntries();let a=s.contents.get(n);return a===void 0?t?{ret:x.ERRNO_SUCCESS,parent_entry:s,filename:n,entry:null}:{ret:x.ERRNO_NOENT,parent_entry:null,filename:null,entry:null}:e.is_dir&&a.stat().filetype!=x.FILETYPE_DIRECTORY?{ret:x.ERRNO_NOTDIR,parent_entry:null,filename:null,entry:null}:{ret:x.ERRNO_SUCCESS,parent_entry:s,filename:n,entry:a}}create_entry_for_path(e,t){let{ret:n,path:i}=Ae.from(e);if(i==null)return{ret:n,entry:null};let{ret:s,parent_entry:a,filename:l,entry:d}=this.get_parent_dir_and_entry_for_path(i,!0);if(a==null||l==null)return{ret:s,entry:null};if(d!=null)return{ret:x.ERRNO_EXIST,entry:null};let f;return t?(f=a.handle.newEntry(l,!0),a.createDirectory(l,f)):(f=a.handle.newEntry(l,!1),a.createFile(l,f)),d=f,{ret:x.ERRNO_SUCCESS,entry:d}}};var xr=class{caller;path;constructor(e,t){this.caller=e,this.path=t}subpath(e){return this.path==="."?e:[this.path,e].join("/")}},Er=class extends xr{fd;open(){this.fd=this.caller.call("path_open",{path:this.path})}close(){this.caller.call("fd_close",{fd:this.fd})}flush(){this.caller.call("fd_flush",{fd:this.fd})}read(e,t){let n=0;t?.at&&(n=t.at);let i=e.byteLength,s=this.caller.call("fd_read",{fd:this.fd,count:i,at:n});if(s===null)return 0;let a;if(e instanceof ArrayBuffer)a=new Uint8Array(e);else if(e instanceof Uint8Array)a=e;else throw new Error("Buffer must be ArrayBuffer or Uint8Array");return a.set(s,0),s.length}write(e,t){let n=0;t?.at&&(n=t.at);let i=new Uint8Array(e);return this.caller.call("fd_write",{fd:this.fd,data:i,at:n})}truncate(e){this.caller.call("path_truncate",{path:this.path,to:e})}getSize(){return this.caller.call("path_size",{path:this.path})}},Nn=class r extends xr{dirCache;lastReadDir;newEntry(e,t){if(t){let n=new r(this.caller,this.subpath(e));return new Ye(n)}else{let n=new Er(this.caller,this.subpath(e));return new Mt(n)}}readDir(){if(performance.now()-this.lastReadDir<1e3)return this.dirCache;this.lastReadDir=performance.now();let e=new Map,t=this.caller.call("path_readdir",{path:this.path})||[];for(let n of t){let i=!1,s=n;s.slice(-1)==="/"&&(i=!0,s=s.slice(0,-1)),e.set(s,this.newEntry(s,i))}return this.dirCache=e,e}removeEntry(e){return this.caller.call("path_remove",{path:this.subpath(e)})}createLink(e,t){return!1}createFile(e,t){return this.caller.call("path_touch",{path:this.subpath(e)})}createDirectory(e,t){return this.caller.call("path_mkdir",{path:this.subpath(e)})}};var Rr=class extends Bt{constructor(){super([])}},Tn=class extends ct{constructor(){super(new Rr)}};function Hl(r){r.wasiImport.poll_oneoff=(e,t,n,i)=>{if(n<0)return x.ERRNO_INVAL;let s=48,a=new DataView(r.inst.exports.memory.buffer,e,n*s),l=32,d=new DataView(r.inst.exports.memory.buffer,t,n*l);for(let b=0;b<n;++b){let fe=function(){let _e=a.getUint32(b*s+T+F,!0),ie=r.fds[_e];if(!(ie instanceof ut))throw new Error(`FD#${_e} cannot be polled!`);return ie},te=function(_e){d.setUint16(b*l+le,x.EVENTTYPE_FD_READ,!0),d.setBigUint64(b*l+v,_e,!0),d.setUint16(b*l+De,0,!0)},O=a.getBigUint64(b*s+0,!0),T=8,U=a.getUint8(b*s+T),F=1,L=0,se=8,le=10,v=16,De=24;switch(d.setBigUint64(b*l+L,O,!0),d.setUint32(b*l+se,x.ERRNO_SUCCESS,!0),U){case x.EVENTTYPE_CLOCK:d.setUint16(b*l+le,x.EVENTTYPE_CLOCK,!0);break;case x.EVENTTYPE_FD_READ:let _e=fe();te(_e.file.size);break;case x.EVENTTYPE_FD_WRITE:te(1n<<31n);break;default:throw new Error(`Unknown event type: ${U}`)}}let f=4;return new DataView(r.inst.exports.memory.buffer,i,f).setUint32(0,n,!0),x.ERRNO_SUCCESS}}var as={};tn(as,{Buffer:()=>Ht,CBORCodec:()=>Yt,CBORDecoder:()=>Mr,CBOREncoder:()=>Br,Call:()=>Xt,Channel:()=>Zt,Client:()=>$e,EOF:()=>Mu,FrameCodec:()=>Xe,FrameDecoder:()=>Wr,FrameEncoder:()=>Gr,HandlerFunc:()=>yt,JSONCodec:()=>Dn,JSONDecoder:()=>Or,JSONEncoder:()=>Sr,NotFoundHandler:()=>ni,Peer:()=>Je,PortConn:()=>Be,PortSession:()=>Zr,Respond:()=>es,RespondMux:()=>ve,Response:()=>Kt,ResponseHeader:()=>$t,Session:()=>rt,VirtualCaller:()=>Jn,channelMaxPacket:()=>Jt,channelWindowSize:()=>rs,connect:()=>Cf,copy:()=>kf,handlerFrom:()=>mf,maxPacketLength:()=>$r,methodProxy:()=>ts,minPacketLength:()=>Xr,open:()=>ci,options:()=>fi});(function(){if(typeof global<"u"&&!global.TextEncoder){let{TextEncoder:r,TextDecoder:e}=Ei("util");global.TextEncoder=r,global.TextDecoder=e}})();var Dn=class{constructor(e=!1){Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.debug=e}encoder(e){return new Sr(e,this.debug)}decoder(e){return new Or(e,this.debug)}},Sr=class{constructor(e,t=!1){Object.defineProperty(this,"w",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.w=e,this.enc=new TextEncoder,this.debug=t}async encode(e){this.debug&&console.log("<<",e);let t=this.enc.encode(JSON.stringify(e)),n=0;for(;n<t.length;)n+=await this.w.write(t.subarray(n))}},Or=class{constructor(e,t=!1){Object.defineProperty(this,"r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.r=e,this.dec=new TextDecoder,this.debug=t}async decode(e){let t=new Uint8Array(e);if(await this.r.read(t)===null)return Promise.resolve(null);let i=JSON.parse(this.dec.decode(t));return this.debug&&console.log(">>",i),Promise.resolve(i)}};var Un;try{Un=new TextDecoder}catch{}var P,Ke,R=0;var zs=[],Kl=105,ql=57342,Xl=57343,Ms=57337;var Vs=6,dt={},vn=zs,Cn=0,G={},q,Nr,Tr=0,jt=0,Q,Ee,X=[],kn=[],ue,oe,Vt,js={useRecords:!1,mapsAsObjects:!0},Gt=!1,qe=class r{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[t,n]of Object.entries(e.keyMap))this.mapKey.set(n,t)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let t=new Map;for(let[n,i]of Object.entries(e))t.set(this._keyMap.hasOwnProperty(n)?this._keyMap[n]:n,i);return t}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[n,i]of Object.entries(this._keyMap))this._mapKey.set(i,n)}let t={};return e.forEach((n,i)=>t[ge(this._mapKey.has(i)?this._mapKey.get(i):i)]=n),t}mapDecode(e,t){let n=this.decode(e);if(this._keyMap)switch(n.constructor.name){case"Array":return n.map(i=>this.decodeKeys(i))}return n}decode(e,t){if(P)return qs(()=>(Dr(),this?this.decode(e,t):r.prototype.decode.call(js,e,t)));Ke=t>-1?t:e.length,R=0,Cn=0,jt=0,Nr=null,vn=zs,Q=null,P=e;try{oe=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(n){throw P=null,e instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof r){if(G=this,ue=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return q=this.structures,Ir();(!q||q.length>0)&&(q=[])}else G=js,(!q||q.length>0)&&(q=[]),ue=null;return Ir()}decodeMultiple(e,t){let n,i=0;try{let s=e.length;Gt=!0;let a=this?this.decode(e,s):Mn.decode(e,s);if(t){if(t(a)===!1)return;for(;R<s;)if(i=R,t(Ir())===!1)return}else{for(n=[a];R<s;)i=R,n.push(Ir());return n}}catch(s){throw s.lastPosition=i,s.values=n,s}finally{Gt=!1,Dr()}}};function Ir(){try{let r=j();if(Q){if(R>=Q.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}R=Q.postBundlePosition,Q=null}if(R==Ke)q=null,P=null,Ee&&(Ee=null);else if(R>Ke){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!Gt)throw new Error("Data read, but end of buffer not reached");return r}catch(r){throw Dr(),(r instanceof RangeError||r.message.startsWith("Unexpected end of buffer"))&&(r.incomplete=!0),r}}function j(){let r=P[R++],e=r>>5;if(r=r&31,r>23)switch(r){case 24:r=P[R++];break;case 25:if(e==7)return Ql();r=oe.getUint16(R),R+=2;break;case 26:if(e==7){let t=oe.getFloat32(R);if(G.useFloat32>2){let n=Ur[(P[R]&127)<<1|P[R+1]>>7];return R+=4,(n*t+(t>0?.5:-.5)>>0)/n}return R+=4,t}r=oe.getUint32(R),R+=4;break;case 27:if(e==7){let t=oe.getFloat64(R);return R+=8,t}if(e>1){if(oe.getUint32(R)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");r=oe.getUint32(R+4)}else G.int64AsNumber?(r=oe.getUint32(R)*4294967296,r+=oe.getUint32(R+4)):r=oe.getBigUint64(R);R+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let t=[],n,i=0;for(;(n=j())!=dt;)t[i++]=n;return e==4?t:e==3?t.join(""):Buffer.concat(t);case 5:let s;if(G.mapsAsObjects){let a={};if(G.keyMap)for(;(s=j())!=dt;)a[ge(G.decodeKey(s))]=j();else for(;(s=j())!=dt;)a[ge(s)]=j();return a}else{Vt&&(G.mapsAsObjects=!0,Vt=!1);let a=new Map;if(G.keyMap)for(;(s=j())!=dt;)a.set(G.decodeKey(s),j());else for(;(s=j())!=dt;)a.set(s,j());return a}case 7:return dt;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+r)}switch(e){case 0:return r;case 1:return~r;case 2:return Zl(r);case 3:if(jt>=R)return Nr.slice(R-Tr,(R+=r)-Tr);if(jt==0&&Ke<140&&r<32){let i=r<16?Ys(r):Jl(r);if(i!=null)return i}return $l(r);case 4:let t=new Array(r);for(let i=0;i<r;i++)t[i]=j();return t;case 5:if(G.mapsAsObjects){let i={};if(G.keyMap)for(let s=0;s<r;s++)i[ge(G.decodeKey(j()))]=j();else for(let s=0;s<r;s++)i[ge(j())]=j();return i}else{Vt&&(G.mapsAsObjects=!0,Vt=!1);let i=new Map;if(G.keyMap)for(let s=0;s<r;s++)i.set(G.decodeKey(j()),j());else for(let s=0;s<r;s++)i.set(j(),j());return i}case 6:if(r>=Ms){let i=q[r&8191];if(i)return i.read||(i.read=Pn(i)),i.read();if(r<65536){if(r==Xl){let s=pt(),a=j(),l=j();Ln(a,l);let d={};if(G.keyMap)for(let f=2;f<s;f++){let m=G.decodeKey(l[f-2]);d[ge(m)]=j()}else for(let f=2;f<s;f++){let m=l[f-2];d[ge(m)]=j()}return d}else if(r==ql){let s=pt(),a=j();for(let l=2;l<s;l++)Ln(a++,j());return j()}else if(r==Ms)return af();if(G.getShared&&(Bn(),i=q[r&8191],i))return i.read||(i.read=Pn(i)),i.read()}}let n=X[r];if(n)return n.handlesRead?n(j):n(j());{let i=j();for(let s=0;s<kn.length;s++){let a=kn[s](r,i);if(a!==void 0)return a}return new Re(i,r)}case 7:switch(r){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let i=(ue||He())[r];if(i!==void 0)return i;throw new Error("Unknown token "+r)}default:if(isNaN(r)){let i=new Error("Unexpected end of CBOR data");throw i.incomplete=!0,i}throw new Error("Unknown CBOR token "+r)}}var Gs=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Pn(r){function e(){let t=P[R++];if(t=t&31,t>23)switch(t){case 24:t=P[R++];break;case 25:t=oe.getUint16(R),R+=2;break;case 26:t=oe.getUint32(R),R+=4;break;default:throw new Error("Expected array header, but got "+P[R-1])}let n=this.compiledReader;for(;n;){if(n.propertyCount===t)return n(j);n=n.next}if(this.slowReads++>=3){let s=this.length==t?this:this.slice(0,t);return n=G.keyMap?new Function("r","return {"+s.map(a=>G.decodeKey(a)).map(a=>Gs.test(a)?ge(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"):new Function("r","return {"+s.map(a=>Gs.test(a)?ge(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"),this.compiledReader&&(n.next=this.compiledReader),n.propertyCount=t,this.compiledReader=n,n(j)}let i={};if(G.keyMap)for(let s=0;s<t;s++)i[ge(G.decodeKey(this[s]))]=j();else for(let s=0;s<t;s++)i[ge(this[s])]=j();return i}return r.slowReads=0,e}function ge(r){return r==="__proto__"?"__proto_":r}var $l=Fn;function Fn(r){let e;if(r<16&&(e=Ys(r)))return e;if(r>64&&Un)return Un.decode(P.subarray(R,R+=r));let t=R+r,n=[];for(e="";R<t;){let i=P[R++];if((i&128)===0)n.push(i);else if((i&224)===192){let s=P[R++]&63;n.push((i&31)<<6|s)}else if((i&240)===224){let s=P[R++]&63,a=P[R++]&63;n.push((i&31)<<12|s<<6|a)}else if((i&248)===240){let s=P[R++]&63,a=P[R++]&63,l=P[R++]&63,d=(i&7)<<18|s<<12|a<<6|l;d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|d&1023),n.push(d)}else n.push(i);n.length>=4096&&(e+=ne.apply(String,n),n.length=0)}return n.length>0&&(e+=ne.apply(String,n)),e}var ne=String.fromCharCode;function Jl(r){let e=R,t=new Array(r);for(let n=0;n<r;n++){let i=P[R++];if((i&128)>0){R=e;return}t[n]=i}return ne.apply(String,t)}function Ys(r){if(r<4)if(r<2){if(r===0)return"";{let e=P[R++];if((e&128)>1){R-=1;return}return ne(e)}}else{let e=P[R++],t=P[R++];if((e&128)>0||(t&128)>0){R-=2;return}if(r<3)return ne(e,t);let n=P[R++];if((n&128)>0){R-=3;return}return ne(e,t,n)}else{let e=P[R++],t=P[R++],n=P[R++],i=P[R++];if((e&128)>0||(t&128)>0||(n&128)>0||(i&128)>0){R-=4;return}if(r<6){if(r===4)return ne(e,t,n,i);{let s=P[R++];if((s&128)>0){R-=5;return}return ne(e,t,n,i,s)}}else if(r<8){let s=P[R++],a=P[R++];if((s&128)>0||(a&128)>0){R-=6;return}if(r<7)return ne(e,t,n,i,s,a);let l=P[R++];if((l&128)>0){R-=7;return}return ne(e,t,n,i,s,a,l)}else{let s=P[R++],a=P[R++],l=P[R++],d=P[R++];if((s&128)>0||(a&128)>0||(l&128)>0||(d&128)>0){R-=8;return}if(r<10){if(r===8)return ne(e,t,n,i,s,a,l,d);{let f=P[R++];if((f&128)>0){R-=9;return}return ne(e,t,n,i,s,a,l,d,f)}}else if(r<12){let f=P[R++],m=P[R++];if((f&128)>0||(m&128)>0){R-=10;return}if(r<11)return ne(e,t,n,i,s,a,l,d,f,m);let b=P[R++];if((b&128)>0){R-=11;return}return ne(e,t,n,i,s,a,l,d,f,m,b)}else{let f=P[R++],m=P[R++],b=P[R++],A=P[R++];if((f&128)>0||(m&128)>0||(b&128)>0||(A&128)>0){R-=12;return}if(r<14){if(r===12)return ne(e,t,n,i,s,a,l,d,f,m,b,A);{let O=P[R++];if((O&128)>0){R-=13;return}return ne(e,t,n,i,s,a,l,d,f,m,b,A,O)}}else{let O=P[R++],T=P[R++];if((O&128)>0||(T&128)>0){R-=14;return}if(r<15)return ne(e,t,n,i,s,a,l,d,f,m,b,A,O,T);let U=P[R++];if((U&128)>0){R-=15;return}return ne(e,t,n,i,s,a,l,d,f,m,b,A,O,T,U)}}}}}function Zl(r){return G.copyBuffers?Uint8Array.prototype.slice.call(P,R,R+=r):P.subarray(R,R+=r)}var Hs=new Float32Array(1),Ar=new Uint8Array(Hs.buffer,0,4);function Ql(){let r=P[R++],e=P[R++],t=(r&127)>>2;if(t===31)return e||r&3?NaN:r&128?-1/0:1/0;if(t===0){let n=((r&3)<<8|e)/16777216;return r&128?-n:n}return Ar[3]=r&128|(t>>1)+56,Ar[2]=(r&7)<<5|e>>3,Ar[1]=e<<5,Ar[0]=0,Hs[0]}var Gc=new Array(4096);var Re=class{constructor(e,t){this.value=e,this.tag=t}};X[0]=r=>new Date(r);X[1]=r=>new Date(Math.round(r*1e3));X[2]=r=>{let e=BigInt(0);for(let t=0,n=r.byteLength;t<n;t++)e=BigInt(r[t])+e<<BigInt(8);return e};X[3]=r=>BigInt(-1)-X[2](r);X[4]=r=>+(r[1]+"e"+r[0]);X[5]=r=>r[1]*Math.exp(r[0]*Math.log(2));var Ln=(r,e)=>{r=r-57344;let t=q[r];t&&t.isShared&&((q.restoreStructures||(q.restoreStructures=[]))[r]=t),q[r]=e,e.read=Pn(e)};X[Kl]=r=>{let e=r.length,t=r[1];Ln(r[0],t);let n={};for(let i=2;i<e;i++){let s=t[i-2];n[ge(s)]=r[i]}return n};X[14]=r=>Q?Q[0].slice(Q.position0,Q.position0+=r):new Re(r,14);X[15]=r=>Q?Q[1].slice(Q.position1,Q.position1+=r):new Re(r,15);var ef={Error,RegExp};X[27]=r=>(ef[r[0]]||Error)(r[1],r[2]);var Ks=r=>{if(P[R++]!=132)throw new Error("Packed values structure must be followed by a 4 element array");let e=r();return ue=ue?e.concat(ue.slice(e.length)):e,ue.prefixes=r(),ue.suffixes=r(),r()};Ks.handlesRead=!0;X[51]=Ks;X[Vs]=r=>{if(!ue)if(G.getShared)Bn();else return new Re(r,Vs);if(typeof r=="number")return ue[16+(r>=0?2*r:-2*r-1)];throw new Error("No support for non-integer packed references yet")};X[28]=r=>{Ee||(Ee=new Map,Ee.id=0);let e=Ee.id++,t=P[R],n;t>>5==4?n=[]:n={};let i={target:n};Ee.set(e,i);let s=r();return i.used?Object.assign(n,s):(i.target=s,s)};X[28].handlesRead=!0;X[29]=r=>{let e=Ee.get(r);return e.used=!0,e.target};X[258]=r=>new Set(r);(X[259]=r=>(G.mapsAsObjects&&(G.mapsAsObjects=!1,Vt=!0),r())).handlesRead=!0;function ht(r,e){return typeof r=="string"?r+e:r instanceof Array?r.concat(e):Object.assign({},r,e)}function He(){if(!ue)if(G.getShared)Bn();else throw new Error("No packed values available");return ue}var tf=1399353956;kn.push((r,e)=>{if(r>=225&&r<=255)return ht(He().prefixes[r-224],e);if(r>=28704&&r<=32767)return ht(He().prefixes[r-28672],e);if(r>=1879052288&&r<=2147483647)return ht(He().prefixes[r-1879048192],e);if(r>=216&&r<=223)return ht(e,He().suffixes[r-216]);if(r>=27647&&r<=28671)return ht(e,He().suffixes[r-27639]);if(r>=1811940352&&r<=1879048191)return ht(e,He().suffixes[r-1811939328]);if(r==tf)return{packedValues:ue,structures:q.slice(0),version:e};if(r==55799)return e});var rf=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,Ws=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],nf=[64,68,69,70,71,72,77,78,79,85,86];for(let r=0;r<Ws.length;r++)sf(Ws[r],nf[r]);function sf(r,e){let t="get"+r.name.slice(0,-5);typeof r!="function"&&(r=null);let n=r.BYTES_PER_ELEMENT;for(let i=0;i<2;i++){if(!i&&n==1)continue;let s=n==2?1:n==4?2:3;X[i?e:e-4]=n==1||i==rf?a=>{if(!r)throw new Error("Could not find typed array for code "+e);return new r(Uint8Array.prototype.slice.call(a,0).buffer)}:a=>{if(!r)throw new Error("Could not find typed array for code "+e);let l=new DataView(a.buffer,a.byteOffset,a.byteLength),d=a.length>>s,f=new r(d),m=l[t];for(let b=0;b<d;b++)f[b]=m.call(l,b<<s,i);return f}}}function af(){let r=pt(),e=R+j();for(let n=2;n<r;n++){let i=pt();R+=i}let t=R;return R=e,Q=[Fn(pt()),Fn(pt())],Q.position0=0,Q.position1=0,Q.postBundlePosition=R,R=t,j()}function pt(){let r=P[R++]&31;if(r>23)switch(r){case 24:r=P[R++];break;case 25:r=oe.getUint16(R),R+=2;break;case 26:r=oe.getUint32(R),R+=4;break}return r}function Bn(){if(G.getShared){let r=qs(()=>(P=null,G.getShared()))||{},e=r.structures||[];G.sharedVersion=r.version,ue=G.sharedValues=r.packedValues,q===!0?G.structures=q=e:q.splice.apply(q,[0,e.length].concat(e))}}function qs(r){let e=Ke,t=R,n=Cn,i=Tr,s=jt,a=Nr,l=vn,d=Ee,f=Q,m=new Uint8Array(P.slice(0,Ke)),b=q,A=G,O=Gt,T=r();return Ke=e,R=t,Cn=n,Tr=i,jt=s,Nr=a,vn=l,Ee=d,Q=f,P=m,Gt=O,q=b,G=A,oe=new DataView(P.buffer,P.byteOffset,P.byteLength),T}function Dr(){P=null,Ee=null,q=null}function Xs(r){X[r.tag]=r.decode}var Ur=new Array(147);for(let r=0;r<256;r++)Ur[r]=+("1e"+Math.floor(45.15-r*.30103));var Mn=new qe({useRecords:!1}),Vn=Mn.decode,of=Mn.decodeMultiple,vr={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};var Cr;try{Cr=new TextEncoder}catch{}var Pr,Hn,Lr=globalThis.Buffer,zt=typeof Lr<"u",jn=zt?Lr.allocUnsafeSlow:Uint8Array,$s=zt?Lr:Uint8Array,Js=256,Zs=zt?4294967296:2144337920;var Gn,w,Y,u=0,Pe,ee=null,lf=61440,ff=/[\u0080-\uFFFF]/,ye=Symbol("record-id"),Wt=class extends qe{constructor(e){super(e),this.offset=0;let t,n,i,s,a,l;e=e||{};let d=$s.prototype.utf8Write?function(o,g,h){return w.utf8Write(o,g,h)}:Cr&&Cr.encodeInto?function(o,g){return Cr.encodeInto(o,w.subarray(g)).written}:!1,f=this,m=e.structures||e.saveStructures,b=e.maxSharedStructures;if(b==null&&(b=m?128:0),b>8190)throw new Error("Maximum maxSharedStructure is 8190");let A=e.sequential;A&&(b=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let O,T,U=e.sharedValues,F;if(U){F=Object.create(null);for(let o=0,g=U.length;o<g;o++)F[U[o]]=o}let L=[],se=0,le=0;this.mapEncode=function(o,g){if(this._keyMap&&!this._mapped)switch(o.constructor.name){case"Array":o=o.map(h=>this.encodeKeys(h));break}return this.encode(o,g)},this.encode=function(o,g){if(w||(w=new jn(8192),Y=new DataView(w.buffer,0,8192),u=0),Pe=w.length-10,Pe-u<2048?(w=new jn(w.length),Y=new DataView(w.buffer,0,w.length),Pe=w.length-10,u=0):g===Yn&&(u=u+7&2147483640),n=u,f.useSelfDescribedHeader&&(Y.setUint32(u,3654940416),u+=3),l=f.structuredClone?new Map:null,f.bundleStrings&&typeof o!="string"?(ee=[],ee.size=1/0):ee=null,i=f.structures,i){if(i.uninitialized){let y=f.getShared()||{};f.structures=i=y.structures||[],f.sharedVersion=y.version;let p=f.sharedValues=y.packedValues;if(p){F={};for(let S=0,I=p.length;S<I;S++)F[p[S]]=S}}let h=i.length;if(h>b&&!A&&(h=b),!i.transitions){i.transitions=Object.create(null);for(let y=0;y<h;y++){let p=i[y];if(!p)continue;let S,I=i.transitions;for(let N=0,D=p.length;N<D;N++){I[ye]===void 0&&(I[ye]=y);let C=p[N];S=I[C],S||(S=I[C]=Object.create(null)),I=S}I[ye]=y|1048576}}A||(i.nextId=h)}if(s&&(s=!1),a=i||[],T=F,e.pack){let h=new Map;if(h.values=[],h.encoder=f,h.maxValues=e.maxPrivatePackedValues||(F?16:1/0),h.objectMap=F||!1,h.samplingPackedValues=O,kr(o,h),h.values.length>0){w[u++]=216,w[u++]=51,Te(4);let y=h.values;v(y),Te(0),Te(0),T=Object.create(F||null);for(let p=0,S=y.length;p<S;p++)T[y[p]]=p}}Gn=g&zn;try{if(Gn)return;if(v(o),ee&&ti(n,v),f.offset=u,l&&l.idsToInsert){u+=l.idsToInsert.length*2,u>Pe&&fe(u),f.offset=u;let h=df(w.subarray(n,u),l.idsToInsert);return l=null,h}return g&Yn?(w.start=n,w.end=u,w):w.subarray(n,u)}finally{if(i){if(le<10&&le++,i.length>b&&(i.length=b),se>1e4)i.transitions=null,le=0,se=0,L.length>0&&(L=[]);else if(L.length>0&&!A){for(let h=0,y=L.length;h<y;h++)L[h][ye]=void 0;L=[]}}if(s&&f.saveShared){f.structures.length>b&&(f.structures=f.structures.slice(0,b));let h=w.subarray(n,u);return f.updateSharedData()===!1?f.encode(o):h}g&gf&&(u=n)}},this.findCommonStringsToPack=()=>(O=new Map,F||(F=Object.create(null)),o=>{let g=o&&o.threshold||4,h=this.pack?o.maxPrivatePackedValues||16:0;U||(U=this.sharedValues=[]);for(let[y,p]of O)p.count>g&&(F[y]=h++,U.push(y),s=!0);for(;this.saveShared&&this.updateSharedData()===!1;);O=null});let v=o=>{u>Pe&&(w=fe(u));var g=typeof o,h;if(g==="string"){if(T){let I=T[o];if(I>=0){I<16?w[u++]=I+224:(w[u++]=198,I&1?v(15-I>>1):v(I-16>>1));return}else if(O&&!e.pack){let N=O.get(o);N?N.count++:O.set(o,{count:1})}}let y=o.length;if(ee&&y>=4&&y<1024){if((ee.size+=y)>lf){let N,D=(ee[0]?ee[0].length*3+ee[1].length:0)+10;u+D>Pe&&(w=fe(u+D)),w[u++]=217,w[u++]=223,w[u++]=249,w[u++]=ee.position?132:130,w[u++]=26,N=u-n,u+=4,ee.position&&ti(n,v),ee=["",""],ee.size=0,ee.position=N}let I=ff.test(o);ee[I?0:1]+=o,w[u++]=I?206:207,v(y);return}let p;y<32?p=1:y<256?p=2:y<65536?p=3:p=5;let S=y*3;if(u+S>Pe&&(w=fe(u+S)),y<64||!d){let I,N,D,C=u+p;for(I=0;I<y;I++)N=o.charCodeAt(I),N<128?w[C++]=N:N<2048?(w[C++]=N>>6|192,w[C++]=N&63|128):(N&64512)===55296&&((D=o.charCodeAt(I+1))&64512)===56320?(N=65536+((N&1023)<<10)+(D&1023),I++,w[C++]=N>>18|240,w[C++]=N>>12&63|128,w[C++]=N>>6&63|128,w[C++]=N&63|128):(w[C++]=N>>12|224,w[C++]=N>>6&63|128,w[C++]=N&63|128);h=C-u-p}else h=d(o,u+p,S);h<24?w[u++]=96|h:h<256?(p<2&&w.copyWithin(u+2,u+1,u+1+h),w[u++]=120,w[u++]=h):h<65536?(p<3&&w.copyWithin(u+3,u+2,u+2+h),w[u++]=121,w[u++]=h>>8,w[u++]=h&255):(p<5&&w.copyWithin(u+5,u+3,u+3+h),w[u++]=122,Y.setUint32(u,h),u+=4),u+=h}else if(g==="number")if(!this.alwaysUseFloat&&o>>>0===o)o<24?w[u++]=o:o<256?(w[u++]=24,w[u++]=o):o<65536?(w[u++]=25,w[u++]=o>>8,w[u++]=o&255):(w[u++]=26,Y.setUint32(u,o),u+=4);else if(!this.alwaysUseFloat&&o>>0===o)o>=-24?w[u++]=31-o:o>=-256?(w[u++]=56,w[u++]=~o):o>=-65536?(w[u++]=57,Y.setUint16(u,~o),u+=2):(w[u++]=58,Y.setUint32(u,~o),u+=4);else{let y;if((y=this.useFloat32)>0&&o<4294967296&&o>=-2147483648){w[u++]=250,Y.setFloat32(u,o);let p;if(y<4||(p=o*Ur[(w[u]&127)<<1|w[u+1]>>7])>>0===p){u+=4;return}else u--}w[u++]=251,Y.setFloat64(u,o),u+=8}else if(g==="object")if(!o)w[u++]=246;else{if(l){let p=l.get(o);if(p){if(w[u++]=216,w[u++]=29,w[u++]=25,!p.references){let S=l.idsToInsert||(l.idsToInsert=[]);p.references=[],S.push(p)}p.references.push(u-n),u+=2;return}else l.set(o,{offset:u-n})}let y=o.constructor;if(y===Object)De(o,!0);else if(y===Array){h=o.length,h<24?w[u++]=128|h:Te(h);for(let p=0;p<h;p++)v(o[p])}else if(y===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(w[u++]=217,w[u++]=1,w[u++]=3),h=o.size,h<24?w[u++]=160|h:h<256?(w[u++]=184,w[u++]=h):h<65536?(w[u++]=185,w[u++]=h>>8,w[u++]=h&255):(w[u++]=186,Y.setUint32(u,h),u+=4),f.keyMap)for(let[p,S]of o)v(f.encodeKey(p)),v(S);else for(let[p,S]of o)v(p),v(S);else{for(let p=0,S=Pr.length;p<S;p++){let I=Hn[p];if(o instanceof I){let N=Pr[p],D=N.tag;D==null&&(D=N.getTag&&N.getTag.call(this,o)),D<24?w[u++]=192|D:D<256?(w[u++]=216,w[u++]=D):D<65536?(w[u++]=217,w[u++]=D>>8,w[u++]=D&255):D>-1&&(w[u++]=218,Y.setUint32(u,D),u+=4),N.encode.call(this,o,v,fe);return}}if(o[Symbol.iterator]){if(Gn){let p=new Error("Iterable should be serialized as iterator");throw p.iteratorNotHandled=!0,p}w[u++]=159;for(let p of o)v(p);w[u++]=255;return}if(o[Symbol.asyncIterator]||Wn(o)){let p=new Error("Iterable/blob should be serialized as iterator");throw p.iteratorNotHandled=!0,p}De(o,!o.hasOwnProperty)}}else if(g==="boolean")w[u++]=o?245:244;else if(g==="bigint"){if(o<BigInt(1)<<BigInt(64)&&o>=0)w[u++]=27,Y.setBigUint64(u,o);else if(o>-(BigInt(1)<<BigInt(64))&&o<0)w[u++]=59,Y.setBigUint64(u,-o-BigInt(1));else if(this.largeBigIntToFloat)w[u++]=251,Y.setFloat64(u,Number(o));else throw new RangeError(o+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");u+=8}else if(g==="undefined")w[u++]=247;else throw new Error("Unknown type: "+g)},De=this.useRecords===!1?this.variableMapSize?o=>{let g=Object.keys(o),h=Object.values(o),y=g.length;y<24?w[u++]=160|y:y<256?(w[u++]=184,w[u++]=y):y<65536?(w[u++]=185,w[u++]=y>>8,w[u++]=y&255):(w[u++]=186,Y.setUint32(u,y),u+=4);let p;if(f.keyMap)for(let S=0;S<y;S++)v(encodeKey(g[S])),v(h[S]);else for(let S=0;S<y;S++)v(g[S]),v(h[S])}:(o,g)=>{w[u++]=185;let h=u-n;u+=2;let y=0;if(f.keyMap)for(let p in o)(g||o.hasOwnProperty(p))&&(v(f.encodeKey(p)),v(o[p]),y++);else for(let p in o)(g||o.hasOwnProperty(p))&&(v(p),v(o[p]),y++);w[h+++n]=y>>8,w[h+n]=y&255}:(o,g)=>{let h,y=a.transitions||(a.transitions=Object.create(null)),p=0,S=0,I,N;if(this.keyMap){N=Object.keys(o).map(C=>this.encodeKey(C)),S=N.length;for(let C=0;C<S;C++){let Rt=N[C];h=y[Rt],h||(h=y[Rt]=Object.create(null),p++),y=h}}else for(let C in o)(g||o.hasOwnProperty(C))&&(h=y[C],h||(y[ye]&1048576&&(I=y[ye]&65535),h=y[C]=Object.create(null),p++),y=h,S++);let D=y[ye];if(D!==void 0)D&=65535,w[u++]=217,w[u++]=D>>8|224,w[u++]=D&255;else if(N||(N=y.__keys__||(y.__keys__=Object.keys(o))),I===void 0?(D=a.nextId++,D||(D=0,a.nextId=1),D>=Js&&(a.nextId=(D=b)+1)):D=I,a[D]=N,D<b){w[u++]=217,w[u++]=D>>8|224,w[u++]=D&255,y=a.transitions;for(let C=0;C<S;C++)(y[ye]===void 0||y[ye]&1048576)&&(y[ye]=D),y=y[N[C]];y[ye]=D|1048576,s=!0}else{if(y[ye]=D,Y.setUint32(u,3655335680),u+=3,p&&(se+=le*p),L.length>=Js-b&&(L.shift()[ye]=void 0),L.push(y),Te(S+2),v(57344+D),v(N),g===null)return;for(let C in o)(g||o.hasOwnProperty(C))&&v(o[C]);return}if(S<24?w[u++]=128|S:Te(S),g!==null)for(let C in o)(g||o.hasOwnProperty(C))&&v(o[C])},fe=o=>{let g;if(o>16777216){if(o-n>Zs)throw new Error("Encoded buffer would be larger than maximum buffer size");g=Math.min(Zs,Math.round(Math.max((o-n)*(o>67108864?1.25:2),4194304)/4096)*4096)}else g=(Math.max(o-n<<2,w.length-1)>>12)+1<<12;let h=new jn(g);return Y=new DataView(h.buffer,0,g),w.copy?w.copy(h,0,n,o):h.set(w.slice(n,o)),u-=n,n=0,Pe=h.length-10,w=h},te=100,_e=1e3;this.encodeAsIterable=function(o,g){return xt(o,g,ie)},this.encodeAsAsyncIterable=function(o,g){return xt(o,g,Et)};function*ie(o,g,h){let y=o.constructor;if(y===Object){let p=f.useRecords!==!1;p?De(o,null):Qs(Object.keys(o).length,160);for(let S in o){let I=o[S];p||v(S),I&&typeof I=="object"?g[S]?yield*ie(I,g[S]):yield*Me(I,g,S):v(I)}}else if(y===Array){let p=o.length;Te(p);for(let S=0;S<p;S++){let I=o[S];I&&(typeof I=="object"||u-n>te)?g.element?yield*ie(I,g.element):yield*Me(I,g,"element"):v(I)}}else if(o[Symbol.iterator]){w[u++]=159;for(let p of o)p&&(typeof p=="object"||u-n>te)?g.element?yield*ie(p,g.element):yield*Me(p,g,"element"):v(p);w[u++]=255}else Wn(o)?(Qs(o.size,64),yield w.subarray(n,u),yield o,me()):o[Symbol.asyncIterator]?(w[u++]=159,yield w.subarray(n,u),yield o,me(),w[u++]=255):v(o);h&&u>n?yield w.subarray(n,u):u-n>te&&(yield w.subarray(n,u),me())}function*Me(o,g,h){let y=u-n;try{v(o),u-n>te&&(yield w.subarray(n,u),me())}catch(p){if(p.iteratorNotHandled)g[h]={},u=n+y,yield*ie.call(this,o,g[h]);else throw p}}function me(){te=_e,f.encode(null,zn)}function xt(o,g,h){return g&&g.chunkThreshold?te=_e=g.chunkThreshold:te=100,o&&typeof o=="object"?(f.encode(null,zn),h(o,f.iterateProperties||(f.iterateProperties={}),!0)):[f.encode(o)]}async function*Et(o,g){for(let h of ie(o,g,!0)){let y=h.constructor;if(y===$s||y===Uint8Array)yield h;else if(Wn(h)){let p=h.stream().getReader(),S;for(;!(S=await p.read()).done;)yield S.value}else if(h[Symbol.asyncIterator])for await(let p of h)me(),p?yield*Et(p,g.async||(g.async={})):yield f.encode(p);else yield h}}}useBuffer(e){w=e,Y=new DataView(w.buffer,w.byteOffset,w.byteLength),u=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let t=this.structures.slice(0),n=new Fr(t,this.sharedValues,this.sharedVersion),i=this.saveShared(n,s=>(s&&s.version||0)==e);return i===!1?(n=this.getShared()||{},this.structures=n.structures||[],this.sharedValues=n.packedValues,this.sharedVersion=n.version,this.structures.nextId=this.structures.length):t.forEach((s,a)=>this.structures[a]=s),i}};function Qs(r,e){r<24?w[u++]=e|r:r<256?(w[u++]=e|24,w[u++]=r):r<65536?(w[u++]=e|25,w[u++]=r>>8,w[u++]=r&255):(w[u++]=e|26,Y.setUint32(u,r),u+=4)}var Fr=class{constructor(e,t,n){this.structures=e,this.packedValues=t,this.version=n}};function Te(r){r<24?w[u++]=128|r:r<256?(w[u++]=152,w[u++]=r):r<65536?(w[u++]=153,w[u++]=r>>8,w[u++]=r&255):(w[u++]=154,Y.setUint32(u,r),u+=4)}var cf=typeof Blob>"u"?function(){}:Blob;function Wn(r){if(r instanceof cf)return!0;let e=r[Symbol.toStringTag];return e==="Blob"||e==="File"}function kr(r,e){switch(typeof r){case"string":if(r.length>3){if(e.objectMap[r]>-1||e.values.length>=e.maxValues)return;let n=e.get(r);if(n)++n.count==2&&e.values.push(r);else if(e.set(r,{count:1}),e.samplingPackedValues){let i=e.samplingPackedValues.get(r);i?i.count++:e.samplingPackedValues.set(r,{count:1})}}break;case"object":if(r)if(r instanceof Array)for(let n=0,i=r.length;n<i;n++)kr(r[n],e);else{let n=!e.encoder.useRecords;for(var t in r)r.hasOwnProperty(t)&&(n&&kr(t,e),kr(r[t],e))}break;case"function":console.log(r)}}var uf=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;Hn=[Date,Set,Error,RegExp,Re,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,Fr];Pr=[{tag:1,encode(r,e){let t=r.getTime()/1e3;(this.useTimestamp32||r.getMilliseconds()===0)&&t>=0&&t<4294967296?(w[u++]=26,Y.setUint32(u,t),u+=4):(w[u++]=251,Y.setFloat64(u,t),u+=8)}},{tag:258,encode(r,e){let t=Array.from(r);e(t)}},{tag:27,encode(r,e){e([r.name,r.message])}},{tag:27,encode(r,e){e(["RegExp",r.source,r.flags])}},{getTag(r){return r.tag},encode(r,e){e(r.value)}},{encode(r,e,t){ei(r,t)}},{getTag(r){if(r.constructor===Uint8Array&&(this.tagUint8Array||zt&&this.tagUint8Array!==!1))return 64},encode(r,e,t){ei(r,t)}},Ne(68,1),Ne(69,2),Ne(70,4),Ne(71,8),Ne(72,1),Ne(77,2),Ne(78,4),Ne(79,8),Ne(85,4),Ne(86,8),{encode(r,e){let t=r.packedValues||[],n=r.structures||[];if(t.values.length>0){w[u++]=216,w[u++]=51,Te(4);let i=t.values;e(i),Te(0),Te(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let s=0,a=i.length;s<a;s++)packedObjectMap[i[s]]=s}if(n){Y.setUint32(u,3655335424),u+=3;let i=n.slice(0);i.unshift(57344),i.push(new Re(r.version,1399353956)),e(i)}else e(new Re(r.version,1399353956))}}];function Ne(r,e){return!uf&&e>1&&(r-=4),{tag:r,encode:function(n,i){let s=n.byteLength,a=n.byteOffset||0,l=n.buffer||n;i(zt?Lr.from(l,a,s):new Uint8Array(l,a,s))}}}function ei(r,e){let t=r.byteLength;t<24?w[u++]=64+t:t<256?(w[u++]=88,w[u++]=t):t<65536?(w[u++]=89,w[u++]=t>>8,w[u++]=t&255):(w[u++]=90,Y.setUint32(u,t),u+=4),u+t>=w.length&&e(u+t),w.set(r.buffer?r:new Uint8Array(r),u),u+=t}function df(r,e){let t,n=e.length*2,i=r.length-n;e.sort((s,a)=>s.offset>a.offset?1:-1);for(let s=0;s<e.length;s++){let a=e[s];a.id=s;for(let l of a.references)r[l++]=s>>8,r[l]=s&255}for(;t=e.pop();){let s=t.offset;r.copyWithin(s+n,s,i),n-=2;let a=s+n;r[a++]=216,r[a++]=28,i=s}return r}function ti(r,e){Y.setUint32(ee.position+r,u-ee.position-r+1);let t=ee;ee=null,e(t[0]),e(t[1])}function Kn(r){if(r.Class){if(!r.encode)throw new Error("Extension has no encode function");Hn.unshift(r.Class),Pr.unshift(r)}Xs(r)}var qn=new Wt({useRecords:!1}),Xn=qn.encode,hf=qn.encodeAsIterable,pf=qn.encodeAsAsyncIterable,{NEVER:yf,ALWAYS:_f,DECIMAL_ROUND:wf,DECIMAL_FIT:bf}=vr,Yn=512,gf=1024,zn=2048;var Yt=class{constructor(e=!1,t){Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.debug=e,t&&t.forEach(Kn)}encoder(e){return new Br(e,this.debug)}decoder(e){return new Mr(e,this.debug)}},Br=class{constructor(e,t=!1){Object.defineProperty(this,"w",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.w=e,this.debug=t}async encode(e){this.debug&&console.log("<<",e);let t=Xn(e),n=0;for(;n<t.length;)n+=await this.w.write(t.subarray(n))}},Mr=class{constructor(e,t=!1){Object.defineProperty(this,"r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.r=e,this.debug=t}async decode(e){let t=new Uint8Array(e),n=0;for(;n<e;){let s=await this.r.read(t.subarray(n));if(s===null)return Promise.resolve(null);n+=s}let i=Vn(t);return this.debug&&console.log(">>",i),Promise.resolve(i)}};function Vr(r,e,t=0){t=Math.max(0,Math.min(t,e.byteLength));let n=e.byteLength-t;return r.byteLength>n&&(r=r.subarray(0,n)),e.set(r,t),r.byteLength}var jr=32*1024,$n=2**32-2,Ht=class{constructor(e){Object.defineProperty(this,"_buf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_off",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._buf=e===void 0?new Uint8Array(0):new Uint8Array(e),this._off=0}bytes(e={copy:!0}){return e.copy===!1?this._buf.subarray(this._off):this._buf.slice(this._off)}empty(){return this._buf.byteLength<=this._off}get length(){return this._buf.byteLength-this._off}get capacity(){return this._buf.buffer.byteLength}truncate(e){if(e===0){this.reset();return}if(e<0||e>this.length)throw Error("bytes.Buffer: truncation out of range");this._reslice(this._off+e)}reset(){this._reslice(0),this._off=0}_tryGrowByReslice(e){let t=this._buf.byteLength;return e<=this.capacity-t?(this._reslice(t+e),t):-1}_reslice(e){this._buf=new Uint8Array(this._buf.buffer,0,e)}readSync(e){if(this.empty())return this.reset(),e.byteLength===0?0:null;let t=Vr(this._buf.subarray(this._off),e);return this._off+=t,t}read(e){let t=this.readSync(e);return Promise.resolve(t)}writeSync(e){let t=this._grow(e.byteLength);return Vr(e,this._buf,t)}write(e){let t=this.writeSync(e);return Promise.resolve(t)}_grow(e){let t=this.length;t===0&&this._off!==0&&this.reset();let n=this._tryGrowByReslice(e);if(n>=0)return n;let i=this.capacity;if(e<=Math.floor(i/2)-t)Vr(this._buf.subarray(this._off),this._buf);else{if(i+e>$n)throw new Error("The buffer cannot be grown beyond the maximum size.");{let s=new Uint8Array(Math.min(2*i+e,$n));Vr(this._buf.subarray(this._off),s),this._buf=s}}return this._off=0,this._reslice(Math.min(t+e,$n)),t}grow(e){if(e<0)throw Error("Buffer.grow: negative count");let t=this._grow(e);this._reslice(t)}async readFrom(e){let t=0,n=new Uint8Array(jr);for(;;){let i=this.capacity-this.length<jr,s=i?n:new Uint8Array(this._buf.buffer,this.length),a=await e.read(s);if(a===null)return t;i?this.writeSync(s.subarray(0,a)):this._reslice(this.length+a),t+=a}}readFromSync(e){let t=0,n=new Uint8Array(jr);for(;;){let i=this.capacity-this.length<jr,s=i?n:new Uint8Array(this._buf.buffer,this.length),a=e.readSync(s);if(a===null)return t;i?this.writeSync(s.subarray(0,a)):this._reslice(this.length+a),t+=a}}};var Xe=class{constructor(e){Object.defineProperty(this,"codec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.codec=e}encoder(e){return new Gr(e,this.codec)}decoder(e){return new Wr(e,this.codec.decoder(e))}},Gr=class{constructor(e,t){Object.defineProperty(this,"w",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.w=e,this.codec=t}async encode(e){let t=new Ht;await this.codec.encoder(t).encode(e);let i=new DataView(new ArrayBuffer(4));i.setUint32(0,t.length);let s=new Uint8Array(t.length+4);s.set(new Uint8Array(i.buffer),0),s.set(t.bytes(),4);let a=0;for(;a<s.length;)a+=await this.w.write(s.subarray(a))}},Wr=class{constructor(e,t){Object.defineProperty(this,"r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.r=e,this.dec=t}async decode(e){let t=new Uint8Array(4);if(await this.r.read(t)===null)return null;let s=new DataView(t.buffer).getUint32(0);return await this.dec.decode(s)}};var $e=class{constructor(e,t){Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.session=e,this.codec=t}async call(e,t){let n=await this.session.open();try{let i=new Xe(this.codec),s=i.encoder(n),a=i.decoder(n);await s.encode({S:e}),await s.encode(t);let l=await a.decode(),d=new Kt(n,i);if(d.error=l.E,d.error!==void 0&&d.error!==null)throw d.error;return d.value=await a.decode(),d.continue=l.C,d.continue||await n.close(),d}catch(i){return await n.close(),Promise.reject(i)}}};function Jn(r){function e(t,n){return new Proxy(Object.assign(()=>{},{path:t,callable:n}),{get(i,s,a){return s.startsWith("__")?Reflect.get(i,s,a):e(i.path?`${i.path}.${s}`:s,i.callable)},apply(i,s,a=[]){return i.callable(i.path,a)}})}return e("",r.call.bind(r))}function yt(r){return{respondRPC:r}}function ni(){return yt((r,e)=>{r.return(new Error(`not found: ${e.selector}`))})}function Zn(r){return r===""?"/":(r[0]!="/"&&(r="/"+r),r=r.replace(".","/"),r.toLowerCase())}var ve=class{constructor(){Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers={}}async respondRPC(e,t){await this.handler(t).respondRPC(e,t)}handler(e){let t=this.match(e.selector);return t||ni()}remove(e){e=Zn(e);let t=this.match(e);return delete this.handlers[e],t||null}match(e){if(e=Zn(e),this.handlers.hasOwnProperty(e))return this.handlers[e];let t=Object.keys(this.handlers).filter(n=>n.endsWith("/"));t.sort((n,i)=>i.length-n.length);for(let n of t)if(e.startsWith(n)){let i=this.handlers[n],s=i;return s.match&&s.match instanceof Function?s.match(e.slice(n.length)):i}return null}handle(e,t){if(e==="")throw"handle: invalid selector";let n=Zn(e),i=t;if(i.match&&i.match instanceof Function&&!n.endsWith("/")&&(n=n+"/"),!t)throw"handle: invalid handler";if(this.match(n))throw"handle: selector already registered";this.handlers[n]=t}};async function es(r,e,t){let n=new Xe(e),i=n.decoder(r),s=await i.decode(),a=new Xt(s.S,r,i);a.caller=new $e(r.session,e);let l=new $t,d=new Qn(r,n,l);return t||(t=new ve),await t.respondRPC(d,a),d.responded||await d.return(null),Promise.resolve()}var Qn=class{constructor(e,t,n){Object.defineProperty(this,"header",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ch",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"responded",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ch=e,this.codec=t,this.header=n,this.responded=!1}send(e){return this.codec.encoder(this.ch).encode(e)}return(e){return this.respond(e,!1)}async continue(e){return await this.respond(e,!0),this.ch}async respond(e,t){return this.responded=!0,this.header.C=t,e instanceof Error&&(this.header.E=e.message,e=null),await this.send(this.header),await this.send(e),t||await this.ch.close(),Promise.resolve()}};var Xt=class{constructor(e,t,n){Object.defineProperty(this,"selector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"channel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"decoder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.selector=e,this.channel=t,this.decoder=n}receive(){return this.decoder.decode()}},$t=class{constructor(){Object.defineProperty(this,"E",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"C",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.E=void 0,this.C=!1}},Kt=class{constructor(e,t){Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"continue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"channel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.channel=e,this.codec=t,this.error=void 0,this.continue=!1}send(e){return this.codec.encoder(this.channel).encode(e)}receive(){return this.codec.decoder(this.channel).decode()}};function mf(r){return r instanceof Function?si(r):xf(r)}function xf(r){let e=new ve;for(let t of Ef(r))if(!(["constructor","respondRPC"].includes(t)||t.startsWith("_")))if(r[t]instanceof Function){let n=si(r[t],r);r[`_${t}RPC`]instanceof Function&&(n={respondRPC:r[`_${t}RPC`].bind(r)}),e.handle(t,n)}else r[t]&&r[t].respondRPC&&e.handle(t,r[t]);return r.respondRPC&&e.handle("/",r),e}function si(r,e){return yt(async(t,n)=>{try{let i=r.apply(e,await n.receive());if(i instanceof Promise){let s=await i;t.return(s)}else t.return(i)}catch(i){if(typeof i=="string"){t.return(new Error(i));return}t.return(i)}})}function Ef(r){let e=new Set;Object.getOwnPropertyNames(r).forEach(t=>e.add(t));for(let t=r;t!=null;t=Object.getPrototypeOf(t))t.constructor.name!=="Object"&&Object.getOwnPropertyNames(t).forEach(n=>e.add(n));return[...e]}function ts(r){function e(t,n){return new Proxy(Object.assign(()=>{},{path:t,callable:n}),{get(i,s,a){return s.startsWith("__")?Reflect.get(i,s,a):e(i.path?`${i.path}.${s}`:s,i.callable)},apply(i,s,a=[]){return i.callable(i.path,a)}})}return e("",r.call.bind(r))}var Je=class{constructor(e,t){Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"codec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"responder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.session=e,this.codec=t,this.caller=new $e(e,t),this.responder=new ve}close(){return this.session.close()}async respond(){for(;;){let e=await this.session.accept();if(e===null)break;es(e,this.codec,this.responder)}}async call(e,t){return this.caller.call(e,t)}handle(e,t){this.responder.handle(e,t)}respondRPC(e,t){this.responder.respondRPC(e,t)}proxy(){return ts(this.caller)}virtualize(){return Jn(this.caller)}};var ii=new Map([[100,12],[101,16],[102,4],[103,8],[104,8],[105,4],[106,4]]);var zr=class{constructor(e){Object.defineProperty(this,"w",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.w=e}async encode(e){_t.messages&&console.log("<<ENC",e);let t=Of(e);_t.bytes&&console.log("<<ENC",t);let n=0;for(;n<t.length;)n+=await this.w.write(t.subarray(n));return n}};function Of(r){if(r.ID===106){let e=r,t=new DataView(new ArrayBuffer(5));return t.setUint8(0,e.ID),t.setUint32(1,e.channelID),new Uint8Array(t.buffer)}if(r.ID===104){let e=r,t=new DataView(new ArrayBuffer(9));t.setUint8(0,e.ID),t.setUint32(1,e.channelID),t.setUint32(5,e.length);let n=new Uint8Array(9+e.length);return n.set(new Uint8Array(t.buffer),0),n.set(e.data,9),n}if(r.ID===105){let e=r,t=new DataView(new ArrayBuffer(5));return t.setUint8(0,e.ID),t.setUint32(1,e.channelID),new Uint8Array(t.buffer)}if(r.ID===100){let e=r,t=new DataView(new ArrayBuffer(13));return t.setUint8(0,e.ID),t.setUint32(1,e.senderID),t.setUint32(5,e.windowSize),t.setUint32(9,e.maxPacketSize),new Uint8Array(t.buffer)}if(r.ID===101){let e=r,t=new DataView(new ArrayBuffer(17));return t.setUint8(0,e.ID),t.setUint32(1,e.channelID),t.setUint32(5,e.senderID),t.setUint32(9,e.windowSize),t.setUint32(13,e.maxPacketSize),new Uint8Array(t.buffer)}if(r.ID===102){let e=r,t=new DataView(new ArrayBuffer(5));return t.setUint8(0,e.ID),t.setUint32(1,e.channelID),new Uint8Array(t.buffer)}if(r.ID===103){let e=r,t=new DataView(new ArrayBuffer(9));return t.setUint8(0,e.ID),t.setUint32(1,e.channelID),t.setUint32(5,e.additionalBytes),new Uint8Array(t.buffer)}throw`marshal of unknown type: ${r}`}function Hr(r,e){let t=new Uint8Array(e),n=0;return r.forEach(i=>{t.set(i,n),n+=i.length}),t}var Le=class{constructor(){Object.defineProperty(this,"q",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"waiters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.q=[],this.waiters=[],this.closed=!1}push(e){if(this.closed)throw"closed queue";if(this.waiters.length>0){let t=this.waiters.shift();t&&t(e);return}this.q.push(e)}shift(){return this.closed?Promise.resolve(null):new Promise(e=>{if(this.q.length>0){e(this.q.shift()||null);return}this.waiters.push(e)})}close(){this.closed||(this.closed=!0,this.waiters.forEach(e=>{e(null)}))}},gt=class{constructor(){Object.defineProperty(this,"gotEOF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"readBuf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"readers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.readBuf=new Uint8Array(0),this.gotEOF=!1,this.readers=[]}read(e){return new Promise(t=>{let n=()=>{if(this.readBuf===void 0){t(null);return}if(this.readBuf.length==0){if(this.gotEOF){this.readBuf=void 0,t(null);return}this.readers.push(n);return}let i=this.readBuf.slice(0,e.length);this.readBuf=this.readBuf.slice(i.length),this.readBuf.length==0&&this.gotEOF&&(this.readBuf=void 0),e.set(i),t(i.length)};n()})}write(e){for(this.readBuf&&(this.readBuf=Hr([this.readBuf,e],this.readBuf.length+e.length));!this.readBuf||this.readBuf.length>0;){let t=this.readers.shift();if(!t)break;t()}return Promise.resolve(e.length)}eof(){this.gotEOF=!0,this.flushReaders()}close(){this.readBuf=void 0,this.flushReaders()}flushReaders(){for(;;){let e=this.readers.shift();if(!e)return;e()}}};var qr=class{constructor(e){Object.defineProperty(this,"r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.r=e}async decode(){let e=await If(this.r);if(e===null)return Promise.resolve(null);_t.bytes&&console.log(">>DEC",e);let t=Af(e);return _t.messages&&console.log(">>DEC",t),t}};async function If(r){let e=new Uint8Array(1);if(await r.read(e)===null)return Promise.resolve(null);let n=e[0],i=ii.get(n);if(i===void 0||n<100||n>106)return Promise.reject(`bad packet: ${n}`);let s=new Uint8Array(i);if(await r.read(s)===null)return Promise.reject("unexpected EOF reading packet");if(n===104){let d=new DataView(s.buffer).getUint32(4),f=0,m=[];for(;f<d;){let b=new Uint8Array(d-f),A=await r.read(b);if(A===null)return Promise.reject("unexpected EOF reading data chunk");f+=A,m.push(b.slice(0,A))}return Hr([e,s,...m],1+s.length+d)}return Hr([e,s],s.length+1)}function Af(r){let e=new DataView(r.buffer);switch(r[0]){case 106:return{ID:r[0],channelID:e.getUint32(1)};case 104:let t=e.getUint32(5),n=new Uint8Array(r.buffer.slice(9));return{ID:r[0],channelID:e.getUint32(1),length:t,data:n};case 105:return{ID:r[0],channelID:e.getUint32(1)};case 100:return{ID:r[0],senderID:e.getUint32(1),windowSize:e.getUint32(5),maxPacketSize:e.getUint32(9)};case 101:return{ID:r[0],channelID:e.getUint32(1),senderID:e.getUint32(5),windowSize:e.getUint32(9),maxPacketSize:e.getUint32(13)};case 102:return{ID:r[0],channelID:e.getUint32(1)};case 103:return{ID:r[0],channelID:e.getUint32(1),additionalBytes:e.getUint32(5)};default:throw`unmarshal of unknown type: ${r[0]}`}}var _t={messages:!1,bytes:!1};var Xr=9,$r=Number.MAX_VALUE,rt=class{constructor(e){Object.defineProperty(this,"conn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"channels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"incoming",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"done",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.conn=e,this.enc=new zr(e),this.dec=new qr(e),this.channels=[],this.incoming=new Le,this.done=this.loop(),this.closed=!1}async open(){let e=this.newChannel();if(e.maxIncomingPayload=Jt,await this.enc.encode({ID:100,windowSize:e.myWindow,maxPacketSize:e.maxIncomingPayload,senderID:e.localId}),await e.ready.shift())return e;throw"failed to open"}accept(){return this.incoming.shift()}async close(){for(let e of Object.keys(this.channels)){let t=parseInt(e);this.channels[t]!==void 0&&this.channels[t].shutdown()}this.conn.close(),this.closed=!0,await this.done}async loop(){try{for(;;){let e=await this.dec.decode();if(e===null){this.close();return}if(e.ID===100){await this.handleOpen(e);continue}let t=e,n=this.getCh(t.channelID);if(n===void 0){if(this.closed)return;console.warn(`invalid channel (${t.channelID}) on op ${t.ID}`);continue}await n.handle(t)}}catch(e){if(e.message&&e.message.contains&&e.message.contains("Connection reset by peer"))return;throw e}}async handleOpen(e){if(e.maxPacketSize<Xr||e.maxPacketSize>$r){await this.enc.encode({ID:102,channelID:e.senderID});return}let t=this.newChannel();t.remoteId=e.senderID,t.maxRemotePayload=e.maxPacketSize,t.remoteWin=e.windowSize,t.maxIncomingPayload=Jt,this.incoming.push(t),await this.enc.encode({ID:101,channelID:t.remoteId,senderID:t.localId,windowSize:t.myWindow,maxPacketSize:t.maxIncomingPayload})}newChannel(){let e=new Zt(this);return e.remoteWin=0,e.myWindow=rs,e.localId=this.addCh(e),e}getCh(e){let t=this.channels[e];return t&&t.localId!==e&&console.log("bad ids:",e,t.localId,t.remoteId),t}addCh(e){return this.channels.forEach((t,n)=>{if(t===void 0)return this.channels[n]=e,n}),this.channels.push(e),this.channels.length-1}rmCh(e){delete this.channels[e]}};var Jt=1<<24,rs=64*Jt,Zt=class{constructor(e){Object.defineProperty(this,"localId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"remoteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxIncomingPayload",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRemotePayload",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ready",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sentEOF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sentClose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"remoteWin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"myWindow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"readBuf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.localId=0,this.remoteId=0,this.maxIncomingPayload=0,this.maxRemotePayload=0,this.sentEOF=!1,this.sentClose=!1,this.remoteWin=0,this.myWindow=0,this.ready=new Le,this.session=e,this.writers=[],this.readBuf=new gt}get id(){return this.localId}async read(e){let t=await this.readBuf.read(e);if(t!==null)try{await this.adjustWindow(t)}catch(n){if(n!=="EOF"&&n.name!=="BadResource")throw n}return t}write(e){return this.sentEOF?Promise.reject("EOF"):new Promise((t,n)=>{let i=0,s=()=>{if(this.sentEOF||this.sentClose){n("EOF");return}if(e.byteLength==0){t(i);return}let a=Math.min(this.maxRemotePayload,e.length),l=this.reserveWindow(a);if(l==0){this.writers.push(s);return}let d=e.slice(0,l);this.send({ID:104,channelID:this.remoteId,length:d.length,data:d}).then(()=>{if(i+=d.length,e=e.slice(d.length),e.length==0){t(i);return}this.writers.push(s)})};s()})}reserveWindow(e){return this.remoteWin<e&&(e=this.remoteWin),this.remoteWin-=e,e}addWindow(e){for(this.remoteWin+=e;this.remoteWin>0;){let t=this.writers.shift();if(!t)break;t()}}async closeWrite(){this.sentEOF=!0,await this.send({ID:105,channelID:this.remoteId}),this.writers.forEach(e=>e()),this.writers=[]}async close(){if(this.readBuf.eof(),!this.sentClose){for(await this.send({ID:106,channelID:this.remoteId}),this.sentClose=!0;await this.ready.shift()!==null;);return}this.shutdown()}shutdown(){this.readBuf.close(),this.writers.forEach(e=>e()),this.ready.close(),this.session.rmCh(this.localId)}async adjustWindow(e){this.myWindow+=e,await this.send({ID:103,channelID:this.remoteId,additionalBytes:e})}send(e){if(this.sentClose)throw"EOF";return this.sentClose=e.ID===106,this.session.enc.encode(e)}handle(e){if(e.ID===104){this.handleData(e);return}if(e.ID===106){this.close();return}if(e.ID===105&&this.readBuf.eof(),e.ID===102){this.session.rmCh(e.channelID),this.ready.push(!1);return}if(e.ID===101){if(e.maxPacketSize<Xr||e.maxPacketSize>$r)throw"invalid max packet size";this.remoteId=e.senderID,this.maxRemotePayload=e.maxPacketSize,this.addWindow(e.windowSize),this.ready.push(!0);return}e.ID===103&&this.addWindow(e.additionalBytes)}handleData(e){if(e.length>this.maxIncomingPayload)throw"incoming packet exceeds maximum payload size";if(this.myWindow<e.length)throw"remote side wrote too much";this.myWindow-=e.length,this.readBuf.write(e.data)}};var is={};tn(is,{Conn:()=>Jr,connect:()=>vf});var li=rn(ns(),1),ss=rn(ns(),1),Tf={WebSocket:li.default},Fu=Df(globalThis,Tf);function Df(r,e){return new Proxy(r,{get(t,n,i){return n in e?e[n]:r[n]},set(t,n,i){return n in e&&delete e[n],r[n]=i,!0},deleteProperty(t,n){let i=!1;return n in e&&(delete e[n],i=!0),n in r&&(delete r[n],i=!0),i},ownKeys(t){let n=Reflect.ownKeys(r),i=Reflect.ownKeys(e),s=new Set(i);return[...n.filter(a=>!s.has(a)),...i]},defineProperty(t,n,i){return n in e&&delete e[n],Reflect.defineProperty(r,n,i),!0},getOwnPropertyDescriptor(t,n){return n in e?Reflect.getOwnPropertyDescriptor(e,n):Reflect.getOwnPropertyDescriptor(r,n)},has(t,n){return n in e||n in r}})}function vf(r,e){return new Promise(t=>{let n=new ss.default(r);n.onopen=()=>t(new Jr(n)),e&&(n.onclose=e)})}var Jr=class{constructor(e){Object.defineProperty(this,"ws",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"waiters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chunks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isClosed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.isClosed=!1,this.waiters=[],this.chunks=[],this.ws=e,this.ws.binaryType="arraybuffer",this.ws.onmessage=n=>{let i=new Uint8Array(n.data);if(this.chunks.push(i),this.waiters.length>0){let s=this.waiters.shift();s&&s()}};let t=this.ws.onclose;this.ws.onclose=n=>{t&&t.bind(this.ws)(n),this.close()}}read(e){return new Promise(t=>{var n=()=>{if(this.isClosed){t(null);return}if(this.chunks.length===0){this.waiters.push(n);return}let i=0;for(;i<e.length;){let s=this.chunks.shift();if(s==null){t(i);return}let a=s.slice(0,e.length-i);if(e.set(a,i),i+=a.length,s.length>a.length){let l=s.slice(a.length);this.chunks.unshift(l)}}t(i)};n()})}write(e){return this.ws.send(e),Promise.resolve(e.byteLength)}close(){this.isClosed||(this.isClosed=!0,this.waiters.forEach(e=>e()),this.ws.close())}};var fi={transport:is};async function Cf(r,e){let t=await fi.transport.connect(r);return ci(t,e)}function ci(r,e,t){let n=new rt(r),i=new Je(n,e);if(t){for(let s in t)i.handle(s,yt(t[s]));i.respond()}return i}var Mu=null;async function kf(r,e){let t=new Uint8Array(32768),n=0;for(;;){let i=await e.read(t);if(i===null)break;n+=await r.write(t.subarray(0,i))}return n}var Be=class{constructor(e){Object.defineProperty(this,"port",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"waiters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chunks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isClosed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.isClosed=!1,this.waiters=[],this.chunks=[],this.port=e,this.port.onmessage=t=>{let n=new Uint8Array(t.data);if(this.chunks.push(n),this.waiters.length>0){let i=this.waiters.shift();i&&i()}}}read(e){return new Promise(t=>{var n=()=>{if(this.isClosed){t(null);return}if(this.chunks.length===0){this.waiters.push(n);return}let i=0;for(;i<e.length;){let s=this.chunks.shift();if(s==null){t(i);return}let a=s.slice(0,e.length-i);if(e.set(a,i),i+=a.length,s.length>a.length){let l=s.slice(a.length);this.chunks.unshift(l)}}t(i)};n()})}write(e){return this.port.postMessage(e,[e.buffer]),Promise.resolve(e.byteLength)}close(){this.isClosed||(this.isClosed=!0,this.waiters.forEach(e=>e()),this.port.close())}};var Zr=class{constructor(e){Object.defineProperty(this,"port",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"channels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"incoming",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.channels=[],this.incoming=new Le,this.closed=!1,this.port=e,this.port.onmessage=t=>{let n=t.data;if(console.log("session message: ",n),n.type==="open"){let i=new Qr(this,n.port);this.channels.push(i),this.incoming.push(i);return}console.error("unknown session message type: ",n.type)}}async open(){let e=new MessageChannel,t=new Qr(this,e.port1);return this.port.postMessage({type:"open",port:e.port2},[e.port2]),t}accept(){return this.incoming.shift()}async close(){for(let e of this.channels)e.shutdown();this.port.close(),this.closed=!0}},Qr=class{constructor(e,t){Object.defineProperty(this,"port",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sentEOF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sentClose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"readBuf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.session=e,this.sentEOF=!1,this.sentClose=!1,this.readBuf=new gt,this.port=t,this.port.onmessage=n=>{let i=n.data;switch(console.log("channel message: ",i),i.type){case"data":this.readBuf.write(i.data);break;case"eof":this.readBuf.eof();break;case"close":this.close();break;default:console.error("unknown channel message type: ",i.type);break}}}async read(e){return await this.readBuf.read(e)}write(e){return this.sentEOF?Promise.reject("EOF"):(this.port.postMessage({type:"data",data:e},[e.buffer]),Promise.resolve(e.byteLength))}async close(){if(this.readBuf.eof(),!this.sentClose){this.port.postMessage({type:"close"}),this.sentClose=!0;return}this.shutdown()}async closeWrite(){this.sentEOF=!0,this.port.postMessage({type:"eof"})}shutdown(){this.readBuf.close(),this.session.channels.splice(this.session.channels.indexOf(this),1)}};var mt=class{constructor(e){let t=new rt(new Be(e));this.peer=new Je(t,new Yt)}async readDir(e){return(await this.peer.call("ReadDir",[e])).value}async makeDir(e){await this.peer.call("Mkdir",[e])}async makeDirAll(e){await this.peer.call("MkdirAll",[e])}async bind(e,t){await this.peer.call("Bind",[e,t])}async unbind(e,t){await this.peer.call("Unbind",[e,t])}async readFile(e){return(await this.peer.call("ReadFile",[e])).value}async readFile2(e){let t=await this.openReadable(e),n=new Response(t);return new Uint8Array(await n.arrayBuffer())}async readText(e){return new TextDecoder().decode(await this.readFile(e))}async waitFor(e,t=1e3){await this.peer.call("WaitFor",[e,t])}async stat(e){return(await this.peer.call("Stat",[e])).value}async writeFile(e,t){return typeof t=="string"&&(t=new TextEncoder().encode(t)),(await this.peer.call("WriteFile",[e,t])).value}async appendFile(e,t){return typeof t=="string"&&(t=new TextEncoder().encode(t)),(await this.peer.call("AppendFile",[e,t])).value}async rename(e,t){await this.peer.call("Rename",[e,t])}async copy(e,t){await this.peer.call("Copy",[e,t])}async remove(e){await this.peer.call("Remove",[e])}async removeAll(e){await this.peer.call("RemoveAll",[e])}async truncate(e,t){await this.peer.call("Truncate",[e,t])}async create(e){return(await this.peer.call("Create",[e])).value}async open(e){return(await this.peer.call("Open",[e])).value}async openFile(e,t,n){return(await this.peer.call("OpenFile",[e,t,n])).value}async read(e,t){return(await this.peer.call("Read",[e,t])).value}async write(e,t){return(await this.peer.call("Write",[e,t])).value}async writeAt(e,t,n){return(await this.peer.call("WriteAt",[e,t,n])).value}async close(e){return(await this.peer.call("Close",[e])).value}async sync(e){return(await this.peer.call("Sync",[e])).value}async fstat(e){return(await this.peer.call("Fstat",[e])).value}async lstat(e){return(await this.peer.call("Lstat",[e])).value}async chmod(e,t){await this.peer.call("Chmod",[e,t])}async chown(e,t,n){await this.peer.call("Chown",[e,t,n])}async fchmod(e,t){await this.peer.call("Fchmod",[e,t])}async fchown(e,t,n){await this.peer.call("Fchown",[e,t,n])}async ftruncate(e,t){await this.peer.call("Ftruncate",[e,t])}async readlink(e){return(await this.peer.call("Readlink",[e])).value}async symlink(e,t){await this.peer.call("Symlink",[e,t])}async chtimes(e,t,n){await this.peer.call("Chtimes",[e,t,n])}async openReadable(e){let t=await this.open(e);return this.readable(t)}async openWritable(e){let t=await this.open(e);return this.writable(t)}writable(e){let t=this;return new WritableStream({write(n){return t.write(e,n)}})}readable(e){let t=this;return new ReadableStream({async pull(n){let i=await t.read(e,1024);i===null&&n.close(),n.enqueue(i)}})}};ReadableStream.prototype[Symbol.asyncIterator]||(ReadableStream.prototype[Symbol.asyncIterator]=async function*(){let r=this.getReader();try{for(;;){let{done:e,value:t}=await r.read();if(e)return;yield t}}finally{r.releaseLock()}});function ui(r){let e=window.__wanix[r];window.list=t=>{e.readDir(t).then(console.log)},window.read=t=>{e.readFile(t).then(n=>new TextDecoder().decode(n)).then(console.log)},window.readBytes=t=>{e.readFile(t).then(console.log)},window.write=(t,n)=>{e.writeFile(t,n)},window.mkdir=t=>{e.makeDir(t)},window.bind=(t,n)=>{e.bind(t,n)},window.unbind=(t,n)=>{e.unbind(t,n)},window.rm=t=>{e.remove(t)},window.stat=t=>{e.stat(t).then(console.log)},window.tail=async t=>{let n=await e.open(t);for(;;){let i=await e.read(n,1024);if(!i)break;console.log(new TextDecoder().decode(i))}e.close(n)},window.makeScreen=()=>{let t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("canvas");t.appendChild(n),t.appendChild(i),t.id="screen",t.style.display="none",document.body.appendChild(t)},window.showScreen=()=>{let t=document.getElementById("screen");t.style.display="block"},window.hideScreen=()=>{let t=document.getElementById("screen");t.style.display="none"}}var _i=rn(hi());var pi=`// Copyright 2018 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

"use strict";

(() => {
	const enosys = () => {
		const err = new Error("not implemented");
		err.code = "ENOSYS";
		return err;
	};

	if (!globalThis.fs) {
		let outputBuf = "";
		globalThis.fs = {
			constants: { O_WRONLY: -1, O_RDWR: -1, O_CREAT: -1, O_TRUNC: -1, O_APPEND: -1, O_EXCL: -1 }, // unused
			writeSync(fd, buf) {
				outputBuf += decoder.decode(buf);
				const nl = outputBuf.lastIndexOf("\\n");
				if (nl != -1) {
					console.log(outputBuf.substring(0, nl));
					outputBuf = outputBuf.substring(nl + 1);
				}
				return buf.length;
			},
			write(fd, buf, offset, length, position, callback) {
				if (offset !== 0 || length !== buf.length || position !== null) {
					callback(enosys());
					return;
				}
				const n = this.writeSync(fd, buf);
				callback(null, n);
			},
			chmod(path, mode, callback) { callback(enosys()); },
			chown(path, uid, gid, callback) { callback(enosys()); },
			close(fd, callback) { callback(enosys()); },
			fchmod(fd, mode, callback) { callback(enosys()); },
			fchown(fd, uid, gid, callback) { callback(enosys()); },
			fstat(fd, callback) { callback(enosys()); },
			fsync(fd, callback) { callback(null); },
			ftruncate(fd, length, callback) { callback(enosys()); },
			lchown(path, uid, gid, callback) { callback(enosys()); },
			link(path, link, callback) { callback(enosys()); },
			lstat(path, callback) { callback(enosys()); },
			mkdir(path, perm, callback) { callback(enosys()); },
			open(path, flags, mode, callback) { callback(enosys()); },
			read(fd, buffer, offset, length, position, callback) { callback(enosys()); },
			readdir(path, callback) { callback(enosys()); },
			readlink(path, callback) { callback(enosys()); },
			rename(from, to, callback) { callback(enosys()); },
			rmdir(path, callback) { callback(enosys()); },
			stat(path, callback) { callback(enosys()); },
			symlink(path, link, callback) { callback(enosys()); },
			truncate(path, length, callback) { callback(enosys()); },
			unlink(path, callback) { callback(enosys()); },
			utimes(path, atime, mtime, callback) { callback(enosys()); },
		};
	}

	if (!globalThis.process) {
		globalThis.process = {
			getuid() { return -1; },
			getgid() { return -1; },
			geteuid() { return -1; },
			getegid() { return -1; },
			getgroups() { throw enosys(); },
			pid: -1,
			ppid: -1,
			umask() { throw enosys(); },
			cwd() { throw enosys(); },
			chdir() { throw enosys(); },
			exit() {},
		}
	}

	if (!globalThis.crypto) {
		throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");
	}

	if (!globalThis.performance) {
		throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");
	}

	if (!globalThis.TextEncoder) {
		throw new Error("globalThis.TextEncoder is not available, polyfill required");
	}

	if (!globalThis.TextDecoder) {
		throw new Error("globalThis.TextDecoder is not available, polyfill required");
	}

	const encoder = new TextEncoder("utf-8");
	const decoder = new TextDecoder("utf-8");

	globalThis.Go = class {
		constructor() {
			this.argv = ["js"];
			this.env = {};
			this.exit = (code) => {
				if (code !== 0) {
					console.warn("exit code:", code);
				}
			};
			this._exitPromise = new Promise((resolve) => {
				this._resolveExitPromise = resolve;
			});
			this._pendingEvent = null;
			this._scheduledTimeouts = new Map();
			this._nextCallbackTimeoutID = 1;

			const setInt64 = (addr, v) => {
				this.mem.setUint32(addr + 0, v, true);
				this.mem.setUint32(addr + 4, Math.floor(v / 4294967296), true);
			}

			const setInt32 = (addr, v) => {
				this.mem.setUint32(addr + 0, v, true);
			}

			const getInt64 = (addr) => {
				const low = this.mem.getUint32(addr + 0, true);
				const high = this.mem.getInt32(addr + 4, true);
				return low + high * 4294967296;
			}

			const loadValue = (addr) => {
				const f = this.mem.getFloat64(addr, true);
				if (f === 0) {
					return undefined;
				}
				if (!isNaN(f)) {
					return f;
				}

				const id = this.mem.getUint32(addr, true);
				return this._values[id];
			}

			const storeValue = (addr, v) => {
				const nanHead = 0x7FF80000;

				if (typeof v === "number" && v !== 0) {
					if (isNaN(v)) {
						this.mem.setUint32(addr + 4, nanHead, true);
						this.mem.setUint32(addr, 0, true);
						return;
					}
					this.mem.setFloat64(addr, v, true);
					return;
				}

				if (v === undefined) {
					this.mem.setFloat64(addr, 0, true);
					return;
				}

				let id = this._ids.get(v);
				if (id === undefined) {
					id = this._idPool.pop();
					if (id === undefined) {
						id = this._values.length;
					}
					this._values[id] = v;
					this._goRefCounts[id] = 0;
					this._ids.set(v, id);
				}
				this._goRefCounts[id]++;
				let typeFlag = 0;
				switch (typeof v) {
					case "object":
						if (v !== null) {
							typeFlag = 1;
						}
						break;
					case "string":
						typeFlag = 2;
						break;
					case "symbol":
						typeFlag = 3;
						break;
					case "function":
						typeFlag = 4;
						break;
				}
				this.mem.setUint32(addr + 4, nanHead | typeFlag, true);
				this.mem.setUint32(addr, id, true);
			}

			const loadSlice = (addr) => {
				const array = getInt64(addr + 0);
				const len = getInt64(addr + 8);
				return new Uint8Array(this._inst.exports.mem.buffer, array, len);
			}

			const loadSliceOfValues = (addr) => {
				const array = getInt64(addr + 0);
				const len = getInt64(addr + 8);
				const a = new Array(len);
				for (let i = 0; i < len; i++) {
					a[i] = loadValue(array + i * 8);
				}
				return a;
			}

			const loadString = (addr) => {
				const saddr = getInt64(addr + 0);
				const len = getInt64(addr + 8);
				return decoder.decode(new DataView(this._inst.exports.mem.buffer, saddr, len));
			}

			const timeOrigin = Date.now() - performance.now();
			this.importObject = {
				_gotest: {
					add: (a, b) => a + b,
				},
				gojs: {
					// Go's SP does not change as long as no Go code is running. Some operations (e.g. calls, getters and setters)
					// may synchronously trigger a Go event handler. This makes Go code get executed in the middle of the imported
					// function. A goroutine can switch to a new stack if the current stack is too small (see morestack function).
					// This changes the SP, thus we have to update the SP used by the imported function.

					// func wasmExit(code int32)
					"runtime.wasmExit": (sp) => {
						sp >>>= 0;
						const code = this.mem.getInt32(sp + 8, true);
						this.exited = true;
						delete this._inst;
						delete this._values;
						delete this._goRefCounts;
						delete this._ids;
						delete this._idPool;
						this.exit(code);
					},

					// func wasmWrite(fd uintptr, p unsafe.Pointer, n int32)
					"runtime.wasmWrite": (sp) => {
						sp >>>= 0;
						const fd = getInt64(sp + 8);
						const p = getInt64(sp + 16);
						const n = this.mem.getInt32(sp + 24, true);
						fs.writeSync(fd, new Uint8Array(this._inst.exports.mem.buffer, p, n));
					},

					// func resetMemoryDataView()
					"runtime.resetMemoryDataView": (sp) => {
						sp >>>= 0;
						this.mem = new DataView(this._inst.exports.mem.buffer);
					},

					// func nanotime1() int64
					"runtime.nanotime1": (sp) => {
						sp >>>= 0;
						setInt64(sp + 8, (timeOrigin + performance.now()) * 1000000);
					},

					// func walltime() (sec int64, nsec int32)
					"runtime.walltime": (sp) => {
						sp >>>= 0;
						const msec = (new Date).getTime();
						setInt64(sp + 8, msec / 1000);
						this.mem.setInt32(sp + 16, (msec % 1000) * 1000000, true);
					},

					// func scheduleTimeoutEvent(delay int64) int32
					"runtime.scheduleTimeoutEvent": (sp) => {
						sp >>>= 0;
						const id = this._nextCallbackTimeoutID;
						this._nextCallbackTimeoutID++;
						this._scheduledTimeouts.set(id, setTimeout(
							() => {
								this._resume();
								while (this._scheduledTimeouts.has(id)) {
									// for some reason Go failed to register the timeout event, log and try again
									// (temporary workaround for https://github.com/golang/go/issues/28975)
									console.warn("scheduleTimeoutEvent: missed timeout event");
									this._resume();
								}
							},
							getInt64(sp + 8),
						));
						this.mem.setInt32(sp + 16, id, true);
					},

					// func clearTimeoutEvent(id int32)
					"runtime.clearTimeoutEvent": (sp) => {
						sp >>>= 0;
						const id = this.mem.getInt32(sp + 8, true);
						clearTimeout(this._scheduledTimeouts.get(id));
						this._scheduledTimeouts.delete(id);
					},

					// func getRandomData(r []byte)
					"runtime.getRandomData": (sp) => {
						sp >>>= 0;
						crypto.getRandomValues(loadSlice(sp + 8));
					},

					// func finalizeRef(v ref)
					"syscall/js.finalizeRef": (sp) => {
						sp >>>= 0;
						const id = this.mem.getUint32(sp + 8, true);
						this._goRefCounts[id]--;
						if (this._goRefCounts[id] === 0) {
							const v = this._values[id];
							this._values[id] = null;
							this._ids.delete(v);
							this._idPool.push(id);
						}
					},

					// func stringVal(value string) ref
					"syscall/js.stringVal": (sp) => {
						sp >>>= 0;
						storeValue(sp + 24, loadString(sp + 8));
					},

					// func valueGet(v ref, p string) ref
					"syscall/js.valueGet": (sp) => {
						sp >>>= 0;
						const result = Reflect.get(loadValue(sp + 8), loadString(sp + 16));
						sp = this._inst.exports.getsp() >>> 0; // see comment above
						storeValue(sp + 32, result);
					},

					// func valueSet(v ref, p string, x ref)
					"syscall/js.valueSet": (sp) => {
						sp >>>= 0;
						Reflect.set(loadValue(sp + 8), loadString(sp + 16), loadValue(sp + 32));
					},

					// func valueDelete(v ref, p string)
					"syscall/js.valueDelete": (sp) => {
						sp >>>= 0;
						Reflect.deleteProperty(loadValue(sp + 8), loadString(sp + 16));
					},

					// func valueIndex(v ref, i int) ref
					"syscall/js.valueIndex": (sp) => {
						sp >>>= 0;
						storeValue(sp + 24, Reflect.get(loadValue(sp + 8), getInt64(sp + 16)));
					},

					// valueSetIndex(v ref, i int, x ref)
					"syscall/js.valueSetIndex": (sp) => {
						sp >>>= 0;
						Reflect.set(loadValue(sp + 8), getInt64(sp + 16), loadValue(sp + 24));
					},

					// func valueCall(v ref, m string, args []ref) (ref, bool)
					"syscall/js.valueCall": (sp) => {
						sp >>>= 0;
						try {
							const v = loadValue(sp + 8);
							const m = Reflect.get(v, loadString(sp + 16));
							const args = loadSliceOfValues(sp + 32);
							const result = Reflect.apply(m, v, args);
							sp = this._inst.exports.getsp() >>> 0; // see comment above
							storeValue(sp + 56, result);
							this.mem.setUint8(sp + 64, 1);
						} catch (err) {
							sp = this._inst.exports.getsp() >>> 0; // see comment above
							storeValue(sp + 56, err);
							this.mem.setUint8(sp + 64, 0);
						}
					},

					// func valueInvoke(v ref, args []ref) (ref, bool)
					"syscall/js.valueInvoke": (sp) => {
						sp >>>= 0;
						try {
							const v = loadValue(sp + 8);
							const args = loadSliceOfValues(sp + 16);
							const result = Reflect.apply(v, undefined, args);
							sp = this._inst.exports.getsp() >>> 0; // see comment above
							storeValue(sp + 40, result);
							this.mem.setUint8(sp + 48, 1);
						} catch (err) {
							sp = this._inst.exports.getsp() >>> 0; // see comment above
							storeValue(sp + 40, err);
							this.mem.setUint8(sp + 48, 0);
						}
					},

					// func valueNew(v ref, args []ref) (ref, bool)
					"syscall/js.valueNew": (sp) => {
						sp >>>= 0;
						try {
							const v = loadValue(sp + 8);
							const args = loadSliceOfValues(sp + 16);
							const result = Reflect.construct(v, args);
							sp = this._inst.exports.getsp() >>> 0; // see comment above
							storeValue(sp + 40, result);
							this.mem.setUint8(sp + 48, 1);
						} catch (err) {
							sp = this._inst.exports.getsp() >>> 0; // see comment above
							storeValue(sp + 40, err);
							this.mem.setUint8(sp + 48, 0);
						}
					},

					// func valueLength(v ref) int
					"syscall/js.valueLength": (sp) => {
						sp >>>= 0;
						setInt64(sp + 16, parseInt(loadValue(sp + 8).length));
					},

					// valuePrepareString(v ref) (ref, int)
					"syscall/js.valuePrepareString": (sp) => {
						sp >>>= 0;
						const str = encoder.encode(String(loadValue(sp + 8)));
						storeValue(sp + 16, str);
						setInt64(sp + 24, str.length);
					},

					// valueLoadString(v ref, b []byte)
					"syscall/js.valueLoadString": (sp) => {
						sp >>>= 0;
						const str = loadValue(sp + 8);
						loadSlice(sp + 16).set(str);
					},

					// func valueInstanceOf(v ref, t ref) bool
					"syscall/js.valueInstanceOf": (sp) => {
						sp >>>= 0;
						this.mem.setUint8(sp + 24, (loadValue(sp + 8) instanceof loadValue(sp + 16)) ? 1 : 0);
					},

					// func copyBytesToGo(dst []byte, src ref) (int, bool)
					"syscall/js.copyBytesToGo": (sp) => {
						sp >>>= 0;
						const dst = loadSlice(sp + 8);
						const src = loadValue(sp + 32);
						if (!(src instanceof Uint8Array || src instanceof Uint8ClampedArray)) {
							this.mem.setUint8(sp + 48, 0);
							return;
						}
						const toCopy = src.subarray(0, dst.length);
						dst.set(toCopy);
						setInt64(sp + 40, toCopy.length);
						this.mem.setUint8(sp + 48, 1);
					},

					// func copyBytesToJS(dst ref, src []byte) (int, bool)
					"syscall/js.copyBytesToJS": (sp) => {
						sp >>>= 0;
						const dst = loadValue(sp + 8);
						const src = loadSlice(sp + 16);
						if (!(dst instanceof Uint8Array || dst instanceof Uint8ClampedArray)) {
							this.mem.setUint8(sp + 48, 0);
							return;
						}
						const toCopy = src.subarray(0, dst.length);
						dst.set(toCopy);
						setInt64(sp + 40, toCopy.length);
						this.mem.setUint8(sp + 48, 1);
					},

					"debug": (value) => {
						console.log(value);
					},
				}
			};
		}

		async run(instance) {
			if (!(instance instanceof WebAssembly.Instance)) {
				throw new Error("Go.run: WebAssembly.Instance expected");
			}
			this._inst = instance;
			this.mem = new DataView(this._inst.exports.mem.buffer);
			this._values = [ // JS values that Go currently has references to, indexed by reference id
				NaN,
				0,
				null,
				true,
				false,
				globalThis,
				this,
			];
			this._goRefCounts = new Array(this._values.length).fill(Infinity); // number of references that Go has to a JS value, indexed by reference id
			this._ids = new Map([ // mapping from JS values to reference ids
				[0, 1],
				[null, 2],
				[true, 3],
				[false, 4],
				[globalThis, 5],
				[this, 6],
			]);
			this._idPool = [];   // unused ids that have been garbage collected
			this.exited = false; // whether the Go program has exited

			// Pass command line arguments and environment variables to WebAssembly by writing them to the linear memory.
			let offset = 4096;

			const strPtr = (str) => {
				const ptr = offset;
				const bytes = encoder.encode(str + "\\0");
				new Uint8Array(this.mem.buffer, offset, bytes.length).set(bytes);
				offset += bytes.length;
				if (offset % 8 !== 0) {
					offset += 8 - (offset % 8);
				}
				return ptr;
			};

			const argc = this.argv.length;

			const argvPtrs = [];
			this.argv.forEach((arg) => {
				argvPtrs.push(strPtr(arg));
			});
			argvPtrs.push(0);

			const keys = Object.keys(this.env).sort();
			keys.forEach((key) => {
				argvPtrs.push(strPtr(\`\${key}=\${this.env[key]}\`));
			});
			argvPtrs.push(0);

			const argv = offset;
			argvPtrs.forEach((ptr) => {
				this.mem.setUint32(offset, ptr, true);
				this.mem.setUint32(offset + 4, 0, true);
				offset += 8;
			});

			// The linker guarantees global data starts from at least wasmMinDataAddr.
			// Keep in sync with cmd/link/internal/ld/data.go:wasmMinDataAddr.
			const wasmMinDataAddr = 4096 + 8192;
			if (offset >= wasmMinDataAddr) {
				throw new Error("total length of command line and environment variables exceeds limit");
			}

			this._inst.exports.run(argc, argv);
			if (this.exited) {
				this._resolveExitPromise();
			}
			await this._exitPromise;
		}

		_resume() {
			if (this.exited) {
				throw new Error("Go program has already exited");
			}
			this._inst.exports.resume();
			if (this.exited) {
				this._resolveExitPromise();
			}
		}

		_makeFuncWrapper(id) {
			const go = this;
			return function () {
				const event = { id: id, this: this, args: arguments };
				go._pendingEvent = event;
				go._resume();
				return event.result;
			};
		}
	}
})();
`;var yi=`// Copyright 2018 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
//
// This file has been modified for use by the TinyGo compiler.

(() => {
	// Map multiple JavaScript environments to a single common API,
	// preferring web standards over Node.js API.
	//
	// Environments considered:
	// - Browsers
	// - Node.js
	// - Electron
	// - Parcel

	if (typeof global !== "undefined") {
		// global already exists
	} else if (typeof window !== "undefined") {
		window.global = window;
	} else if (typeof self !== "undefined") {
		self.global = self;
	} else {
		throw new Error("cannot export Go (neither global, window nor self is defined)");
	}

	if (!global.require && typeof require !== "undefined") {
		global.require = require;
	}

	if (!global.fs && global.require) {
		global.fs = require("node:fs");
	}

	const enosys = () => {
		const err = new Error("not implemented");
		err.code = "ENOSYS";
		return err;
	};

	if (!global.fs) {
		let outputBuf = "";
		global.fs = {
			constants: { O_WRONLY: -1, O_RDWR: -1, O_CREAT: -1, O_TRUNC: -1, O_APPEND: -1, O_EXCL: -1 }, // unused
			writeSync(fd, buf) {
				outputBuf += decoder.decode(buf);
				const nl = outputBuf.lastIndexOf("\\n");
				if (nl != -1) {
					console.log(outputBuf.substr(0, nl));
					outputBuf = outputBuf.substr(nl + 1);
				}
				return buf.length;
			},
			write(fd, buf, offset, length, position, callback) {
				if (offset !== 0 || length !== buf.length || position !== null) {
					callback(enosys());
					return;
				}
				const n = this.writeSync(fd, buf);
				callback(null, n);
			},
			chmod(path, mode, callback) { callback(enosys()); },
			chown(path, uid, gid, callback) { callback(enosys()); },
			close(fd, callback) { callback(enosys()); },
			fchmod(fd, mode, callback) { callback(enosys()); },
			fchown(fd, uid, gid, callback) { callback(enosys()); },
			fstat(fd, callback) { callback(enosys()); },
			fsync(fd, callback) { callback(null); },
			ftruncate(fd, length, callback) { callback(enosys()); },
			lchown(path, uid, gid, callback) { callback(enosys()); },
			link(path, link, callback) { callback(enosys()); },
			lstat(path, callback) { callback(enosys()); },
			mkdir(path, perm, callback) { callback(enosys()); },
			open(path, flags, mode, callback) { callback(enosys()); },
			read(fd, buffer, offset, length, position, callback) { callback(enosys()); },
			readdir(path, callback) { callback(enosys()); },
			readlink(path, callback) { callback(enosys()); },
			rename(from, to, callback) { callback(enosys()); },
			rmdir(path, callback) { callback(enosys()); },
			stat(path, callback) { callback(enosys()); },
			symlink(path, link, callback) { callback(enosys()); },
			truncate(path, length, callback) { callback(enosys()); },
			unlink(path, callback) { callback(enosys()); },
			utimes(path, atime, mtime, callback) { callback(enosys()); },
		};
	}

	if (!global.process) {
		global.process = {
			getuid() { return -1; },
			getgid() { return -1; },
			geteuid() { return -1; },
			getegid() { return -1; },
			getgroups() { throw enosys(); },
			pid: -1,
			ppid: -1,
			umask() { throw enosys(); },
			cwd() { throw enosys(); },
			chdir() { throw enosys(); },
		}
	}

	if (!global.crypto) {
		const nodeCrypto = require("node:crypto");
		global.crypto = {
			getRandomValues(b) {
				nodeCrypto.randomFillSync(b);
			},
		};
	}

	if (!global.performance) {
		global.performance = {
			now() {
				const [sec, nsec] = process.hrtime();
				return sec * 1000 + nsec / 1000000;
			},
		};
	}

	if (!global.TextEncoder) {
		global.TextEncoder = require("node:util").TextEncoder;
	}

	if (!global.TextDecoder) {
		global.TextDecoder = require("node:util").TextDecoder;
	}

	// End of polyfills for common API.

	const encoder = new TextEncoder("utf-8");
	const decoder = new TextDecoder("utf-8");
	let reinterpretBuf = new DataView(new ArrayBuffer(8));
	var logLine = [];
	const wasmExit = {}; // thrown to exit via proc_exit (not an error)

	global.Go = class {
		constructor() {
			this._callbackTimeouts = new Map();
			this._nextCallbackTimeoutID = 1;

			const mem = () => {
				// The buffer may change when requesting more memory.
				return new DataView(this._inst.exports.memory.buffer);
			}

			const unboxValue = (v_ref) => {
				reinterpretBuf.setBigInt64(0, v_ref, true);
				const f = reinterpretBuf.getFloat64(0, true);
				if (f === 0) {
					return undefined;
				}
				if (!isNaN(f)) {
					return f;
				}

				const id = v_ref & 0xffffffffn;
				return this._values[id];
			}


			const loadValue = (addr) => {
				let v_ref = mem().getBigUint64(addr, true);
				return unboxValue(v_ref);
			}

			const boxValue = (v) => {
				const nanHead = 0x7FF80000n;

				if (typeof v === "number") {
					if (isNaN(v)) {
						return nanHead << 32n;
					}
					if (v === 0) {
						return (nanHead << 32n) | 1n;
					}
					reinterpretBuf.setFloat64(0, v, true);
					return reinterpretBuf.getBigInt64(0, true);
				}

				switch (v) {
					case undefined:
						return 0n;
					case null:
						return (nanHead << 32n) | 2n;
					case true:
						return (nanHead << 32n) | 3n;
					case false:
						return (nanHead << 32n) | 4n;
				}

				let id = this._ids.get(v);
				if (id === undefined) {
					id = this._idPool.pop();
					if (id === undefined) {
						id = BigInt(this._values.length);
					}
					this._values[id] = v;
					this._goRefCounts[id] = 0;
					this._ids.set(v, id);
				}
				this._goRefCounts[id]++;
				let typeFlag = 1n;
				switch (typeof v) {
					case "string":
						typeFlag = 2n;
						break;
					case "symbol":
						typeFlag = 3n;
						break;
					case "function":
						typeFlag = 4n;
						break;
				}
				return id | ((nanHead | typeFlag) << 32n);
			}

			const storeValue = (addr, v) => {
				let v_ref = boxValue(v);
				mem().setBigUint64(addr, v_ref, true);
			}

			const loadSlice = (array, len, cap) => {
				return new Uint8Array(this._inst.exports.memory.buffer, array, len);
			}

			const loadSliceOfValues = (array, len, cap) => {
				const a = new Array(len);
				for (let i = 0; i < len; i++) {
					a[i] = loadValue(array + i * 8);
				}
				return a;
			}

			const loadString = (ptr, len) => {
				return decoder.decode(new DataView(this._inst.exports.memory.buffer, ptr, len));
			}

			const timeOrigin = Date.now() - performance.now();
			this.importObject = {
				wasi_snapshot_preview1: {
					// https://github.com/WebAssembly/WASI/blob/main/phases/snapshot/docs.md#fd_write
					fd_write: function(fd, iovs_ptr, iovs_len, nwritten_ptr) {
						let nwritten = 0;
						if (fd == 1) {
							for (let iovs_i=0; iovs_i<iovs_len;iovs_i++) {
								let iov_ptr = iovs_ptr+iovs_i*8; // assuming wasm32
								let ptr = mem().getUint32(iov_ptr + 0, true);
								let len = mem().getUint32(iov_ptr + 4, true);
								nwritten += len;
								for (let i=0; i<len; i++) {
									let c = mem().getUint8(ptr+i);
									if (c == 13) { // CR
										// ignore
									} else if (c == 10) { // LF
										// write line
										let line = decoder.decode(new Uint8Array(logLine));
										logLine = [];
										console.log(line);
									} else {
										logLine.push(c);
									}
								}
							}
						} else {
							console.error('invalid file descriptor:', fd);
						}
						mem().setUint32(nwritten_ptr, nwritten, true);
						return 0;
					},
					fd_close: () => 0,      // dummy
					fd_fdstat_get: () => 0, // dummy
					fd_seek: () => 0,       // dummy
					proc_exit: (code) => {
						this.exited = true;
						this.exitCode = code;
						this._resolveExitPromise();
						throw wasmExit;
					},
					random_get: (bufPtr, bufLen) => {
						crypto.getRandomValues(loadSlice(bufPtr, bufLen));
						return 0;
					},
				},
				gojs: {
					// func ticks() int64
					"runtime.ticks": () => {
						return BigInt((timeOrigin + performance.now()) * 1e6);
					},

					// func sleepTicks(timeout int64)
					"runtime.sleepTicks": (timeout) => {
						// Do not sleep, only reactivate scheduler after the given timeout.
						setTimeout(() => {
							if (this.exited) return;
							try {
								this._inst.exports.go_scheduler();
							} catch (e) {
								if (e !== wasmExit) throw e;
							}
						}, Number(timeout)/1e6);
					},

					// func finalizeRef(v ref)
					"syscall/js.finalizeRef": (v_ref) => {
						// Note: TinyGo does not support finalizers so this is only called
						// for one specific case, by js.go:jsString. and can/might leak memory.
						const id = v_ref & 0xffffffffn;
						if (this._goRefCounts?.[id] !== undefined) {
							this._goRefCounts[id]--;
							if (this._goRefCounts[id] === 0) {
								const v = this._values[id];
								this._values[id] = null;
								this._ids.delete(v);
								this._idPool.push(id);
							}
						} else {
							console.error("syscall/js.finalizeRef: unknown id", id);
						}
					},

					// func stringVal(value string) ref
					"syscall/js.stringVal": (value_ptr, value_len) => {
						value_ptr >>>= 0;
						const s = loadString(value_ptr, value_len);
						return boxValue(s);
					},

					// func valueGet(v ref, p string) ref
					"syscall/js.valueGet": (v_ref, p_ptr, p_len) => {
						let prop = loadString(p_ptr, p_len);
						let v = unboxValue(v_ref);
						let result = Reflect.get(v, prop);
						return boxValue(result);
					},

					// func valueSet(v ref, p string, x ref)
					"syscall/js.valueSet": (v_ref, p_ptr, p_len, x_ref) => {
						const v = unboxValue(v_ref);
						const p = loadString(p_ptr, p_len);
						const x = unboxValue(x_ref);
						Reflect.set(v, p, x);
					},

					// func valueDelete(v ref, p string)
					"syscall/js.valueDelete": (v_ref, p_ptr, p_len) => {
						const v = unboxValue(v_ref);
						const p = loadString(p_ptr, p_len);
						Reflect.deleteProperty(v, p);
					},

					// func valueIndex(v ref, i int) ref
					"syscall/js.valueIndex": (v_ref, i) => {
						return boxValue(Reflect.get(unboxValue(v_ref), i));
					},

					// valueSetIndex(v ref, i int, x ref)
					"syscall/js.valueSetIndex": (v_ref, i, x_ref) => {
						Reflect.set(unboxValue(v_ref), i, unboxValue(x_ref));
					},

					// func valueCall(v ref, m string, args []ref) (ref, bool)
					"syscall/js.valueCall": (ret_addr, v_ref, m_ptr, m_len, args_ptr, args_len, args_cap) => {
						const v = unboxValue(v_ref);
						const name = loadString(m_ptr, m_len);
						const args = loadSliceOfValues(args_ptr, args_len, args_cap);
						try {
							const m = Reflect.get(v, name);
							storeValue(ret_addr, Reflect.apply(m, v, args));
							mem().setUint8(ret_addr + 8, 1);
						} catch (err) {
							storeValue(ret_addr, err);
							mem().setUint8(ret_addr + 8, 0);
						}
					},

					// func valueInvoke(v ref, args []ref) (ref, bool)
					"syscall/js.valueInvoke": (ret_addr, v_ref, args_ptr, args_len, args_cap) => {
						try {
							const v = unboxValue(v_ref);
							const args = loadSliceOfValues(args_ptr, args_len, args_cap);
							storeValue(ret_addr, Reflect.apply(v, undefined, args));
							mem().setUint8(ret_addr + 8, 1);
						} catch (err) {
							storeValue(ret_addr, err);
							mem().setUint8(ret_addr + 8, 0);
						}
					},

					// func valueNew(v ref, args []ref) (ref, bool)
					"syscall/js.valueNew": (ret_addr, v_ref, args_ptr, args_len, args_cap) => {
						const v = unboxValue(v_ref);
						const args = loadSliceOfValues(args_ptr, args_len, args_cap);
						try {
							storeValue(ret_addr, Reflect.construct(v, args));
							mem().setUint8(ret_addr + 8, 1);
						} catch (err) {
							storeValue(ret_addr, err);
							mem().setUint8(ret_addr+ 8, 0);
						}
					},

					// func valueLength(v ref) int
					"syscall/js.valueLength": (v_ref) => {
						return unboxValue(v_ref).length;
					},

					// valuePrepareString(v ref) (ref, int)
					"syscall/js.valuePrepareString": (ret_addr, v_ref) => {
						const s = String(unboxValue(v_ref));
						const str = encoder.encode(s);
						storeValue(ret_addr, str);
						mem().setInt32(ret_addr + 8, str.length, true);
					},

					// valueLoadString(v ref, b []byte)
					"syscall/js.valueLoadString": (v_ref, slice_ptr, slice_len, slice_cap) => {
						const str = unboxValue(v_ref);
						loadSlice(slice_ptr, slice_len, slice_cap).set(str);
					},

					// func valueInstanceOf(v ref, t ref) bool
					"syscall/js.valueInstanceOf": (v_ref, t_ref) => {
 						return unboxValue(v_ref) instanceof unboxValue(t_ref);
					},

					// func copyBytesToGo(dst []byte, src ref) (int, bool)
					"syscall/js.copyBytesToGo": (ret_addr, dest_addr, dest_len, dest_cap, src_ref) => {
						let num_bytes_copied_addr = ret_addr;
						let returned_status_addr = ret_addr + 4; // Address of returned boolean status variable

						const dst = loadSlice(dest_addr, dest_len);
						const src = unboxValue(src_ref);
						if (!(src instanceof Uint8Array || src instanceof Uint8ClampedArray)) {
							mem().setUint8(returned_status_addr, 0); // Return "not ok" status
							return;
						}
						const toCopy = src.subarray(0, dst.length);
						dst.set(toCopy);
						mem().setUint32(num_bytes_copied_addr, toCopy.length, true);
						mem().setUint8(returned_status_addr, 1); // Return "ok" status
					},

					// copyBytesToJS(dst ref, src []byte) (int, bool)
					// Originally copied from upstream Go project, then modified:
					//   https://github.com/golang/go/blob/3f995c3f3b43033013013e6c7ccc93a9b1411ca9/misc/wasm/wasm_exec.js#L404-L416
					"syscall/js.copyBytesToJS": (ret_addr, dst_ref, src_addr, src_len, src_cap) => {
						let num_bytes_copied_addr = ret_addr;
						let returned_status_addr = ret_addr + 4; // Address of returned boolean status variable

						const dst = unboxValue(dst_ref);
						const src = loadSlice(src_addr, src_len);
						if (!(dst instanceof Uint8Array || dst instanceof Uint8ClampedArray)) {
							mem().setUint8(returned_status_addr, 0); // Return "not ok" status
							return;
						}
						const toCopy = src.subarray(0, dst.length);
						dst.set(toCopy);
						mem().setUint32(num_bytes_copied_addr, toCopy.length, true);
						mem().setUint8(returned_status_addr, 1); // Return "ok" status
					},
				}
			};

			// Go 1.20 uses 'env'. Go 1.21 uses 'gojs'.
			// For compatibility, we use both as long as Go 1.20 is supported.
			this.importObject.env = this.importObject.gojs;
		}

		async run(instance) {
			this._inst = instance;
			this._values = [ // JS values that Go currently has references to, indexed by reference id
				NaN,
				0,
				null,
				true,
				false,
				global,
				this,
			];
			this._goRefCounts = []; // number of references that Go has to a JS value, indexed by reference id
			this._ids = new Map();  // mapping from JS values to reference ids
			this._idPool = [];      // unused ids that have been garbage collected
			this.exited = false;    // whether the Go program has exited
			this.exitCode = 0;

			if (this._inst.exports._start) {
				let exitPromise = new Promise((resolve, reject) => {
					this._resolveExitPromise = resolve;
				});

				// Run program, but catch the wasmExit exception that's thrown
				// to return back here.
				try {
					this._inst.exports._start();
				} catch (e) {
					if (e !== wasmExit) throw e;
				}

				await exitPromise;
				return this.exitCode;
			} else {
				this._inst.exports._initialize();
			}
		}

		_resume() {
			if (this.exited) {
				throw new Error("Go program has already exited");
			}
			try {
				this._inst.exports.resume();
			} catch (e) {
				if (e !== wasmExit) throw e;
			}
			if (this.exited) {
				this._resolveExitPromise();
			}
		}

		_makeFuncWrapper(id) {
			const go = this;
			return function () {
				const event = { id: id, this: this, args: arguments };
				go._pendingEvent = event;
				go._resume();
				return event.result;
			};
		}
	}

	if (
		global.require &&
		global.require.main === module &&
		global.process &&
		global.process.versions &&
		!global.process.versions.electron
	) {
		if (process.argv.length != 3) {
			console.error("usage: go_js_wasm_exec [wasm binary] [arguments]");
			process.exit(1);
		}

		const go = new Go();
		WebAssembly.instantiate(fs.readFileSync(process.argv[2]), go.importObject).then(async (result) => {
			let exitCode = await go.run(result.instance);
			process.exit(exitCode);
		}).catch((err) => {
			console.error(err);
			process.exit(1);
		});
	}
})();
`;var ls=class extends mt{constructor(e={}){let t=new MessageChannel;super(t.port2),this.config=e,this._id=Math.random().toString(36).substring(2,15),this._sys=t,this._ready=new Promise(n=>this._wasmReady=n),window.__wanix||(window.__wanix={pending:[]}),window.__wanix.pending.push(this),window.__wanix[this._id]=this,e.wasm===void 0&&(e.wasm="./wanix.wasm"),e.helpers&&ui(this._id),e.bundle?this._loadBundle(e.bundle):e.wasm&&fetch(e.wasm).then(n=>n.arrayBuffer()).then(this._loadWasm)}ready(){return this._ready}createPort(){}_portConn(e){return new Be(e)}async _loadBundle(e){console.log("loading bundle",e);let n=(await fetch(e)).body.pipeThrough(new DecompressionStream("gzip"));this._bundle=await new Response(n).arrayBuffer();let i=!1;await(0,_i.default)(this._bundle.slice()).progress(s=>{s.name.replace(/^\.\//,"")==="wanix.wasm"&&(i=!0,console.log("loading wasm from bundle"),this._loadWasm(s.buffer))}),i||fetch(this.config.wasm).then(s=>s.arrayBuffer()).then(this._loadWasm)}async _loadWasm(e){let t=new Uint8Array(e),n=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!1}).decode(t),i=document.createElement("script");n.includes("tinygo_launch")?(console.log("TinyGo WASM detected"),i.textContent=yi):(console.log("Go WASM detected"),i.textContent=pi),document.head.appendChild(i);let s=new window.Go;WebAssembly.instantiate(t,s.importObject).then(a=>{s.run(a.instance)})}};globalThis.window&&(window.WanixRuntime=ls,window.WanixHandle=mt);var fs=class{ws;waiters;chunks;isClosed;constructor(e){this.isClosed=!1,this.waiters=[],this.chunks=[],this.ws=new WebSocket(e),this.ws.binaryType="arraybuffer",this.ws.onmessage=n=>{let i=new Uint8Array(n.data);if(this.chunks.push(i),this.waiters.length>0){let s=this.waiters.shift();s&&s()}};let t=this.ws.onclose;this.ws.onclose=n=>{t&&t.bind(this.ws)(n),this.close()}}read(e){return new Promise(t=>{var n=()=>{if(this.isClosed){t(null);return}if(this.chunks.length===0){this.waiters.push(n);return}let i=0;for(;i<e.length;){let s=this.chunks.shift();if(s==null){t(i);return}let a=s.slice(0,e.length-i);if(e.set(a,i),i+=a.length,s.length>a.length){let l=s.slice(a.length);this.chunks.unshift(l)}}t(i)};n()})}write(e){return this.ws.send(e),Promise.resolve(e.byteLength)}close(){this.isClosed||(this.isClosed=!0,this.waiters.forEach(e=>e()),this.ws.close())}};typeof window<"u"&&(window.WanixSocket=fs);export{En as CallBuffer,gr as ConsoleStdout,Ye as Directory,Nn as DirectoryHandle,Rr as EmptyFile,Mt as File,Er as FileHandle,Tn as OpenEmptyFile,ut as OpenFile,An as PreopenDirectory,Bs as WASI,ft as WASIProcExit,mt as WanixHandle,ls as WanixRuntime,fs as WanixSocket,Hl as applyPatchPollOneoff,as as duplex};
